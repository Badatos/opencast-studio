{"version":3,"sources":["default-settings.js","ui/about.js","ui/opencast-header.js","languages.js","ui/languages-select.js","ui/notification.js","opencast-api.js","ui/settings-form.js","ui/settings.js","ui/media-device.js","util.js","ui/media-devices.js","download-blob.js","recorder.js","event-emitter.js","ui/recording-buttons.js","ui/clock.js","ui/recording-state.js","ui/form-field.js","ui/recording-preview.js","ui/save-creation.js","ui/recording-controls.js","ui/toolbar.js","ui/warnings.js","ui/studio.js","App.js","use-local-storage.js"],"names":["defaultSettings","serverUrl","workflowId","loginName","loginPassword","connected","Container","props","sx","maxWidth","mx","px","Code","background","color","borderWidth","borderStyle","borderColor","borderLeftWidth","borderLeftColor","fontFamily","lineHeight","my","py","overflow","pageBreakInside","wordWrap","Impressum","h2","p","h3","icon","faGlobeEurope","a","href","faEnvelope","faPhone","About","className","h1","process","aria-label","as","textAlign","variant","to","BetaBubble","position","top","fontSize","verticalAlign","display","borderRadius","padding","Brand","media","srcSet","src","alt","height","OpencastHeader","backgroundColor","justifyContent","languages","short","long","rtl","LanguagesSelect","i18n","useTranslation","defaultValue","language","map","onClick","changeLanguage","bind","value","key","Notification","isDanger","rest","marginBottom","OpencastAPI","settings","this","server_url","endsWith","slice","workflow_id","username","password","login","validateState","recordings","onsuccess","onloginfailed","onserverunreachable","oninetorpermfailed","title","creator","isLoggedIn","uploadFromRecordings","onnotloggedin","getMediaPackage","then","mp","dc","DOMParser","parseFromString","dc_created","getElementsByTagName","dc_creator","dc_title","textContent","Date","now","toISOString","addDCCatalog","data","XMLSerializer","serializeToString","filter","Boolean","deviceType","trackFlavor","downloadName","addTrack","ingest","getMeInfo","me_info_json","me_info","url","axios","method","withCredentials","get","responseType","flavor","FormData","append","track","track_filename","tags","Input","errors","label","name","register","required","type","t","mb","fontWeight","boxSizing","clear","aria-invalid","aria-describedby","autoComplete","ref","id","mt","SettingsForm","useForm","defaultValues","handleSubmit","reset","onSubmit","handleCancel","Settings","useState","error","setError","history","useHistory","from","useLocation","state","pathname","returnToTheStudio","replace","ocUploader","checkConnection","handleUpdate","console","log","pb","MediaDevice","stream","videoRef","useRef","useEffect","current","srcObject","data-title","boxShadow","zIndex","cursor","flexDirection","alignItems","autoPlay","muted","outline","left","width","flex","isDisplayCaptureSupported","navigator","mediaDevices","test","platform","userAgent","isUserCaptureSupported","MediaDevices","flexWrap","displayMediaOptions","video","audio","getDisplayMedia","catch","err","toast","desktopStream","setDesktopStream","faDesktop","userMediaOptions","ideal","max","getUserMedia","videoStream","setVideoStream","faVideo","downloadBlob","blob","document","createElement","download","rel","URL","createObjectURL","setTimeout","revokeObjectURL","node","dispatchEvent","MouseEvent","e","evt","createEvent","initMouseEvent","window","click","findSupportedMimeType","list","MediaRecorder","find","mimeType","isTypeSupported","Recorder","getVideoTracks","length","_recData","recorder","ondataavailable","size","push","onerror","emit","onstart","result","onstop","Blob","Object","defineProperty","isRecording","isPaused","delay","resume","start","pause","stop","_completeFns","_onceFns","ev","fnObj","completeFns","token","Math","random","toString","substring","keys","indexOf","fn","scope","onceFns","val","args","Array","prototype","call","arguments","forEach","fnType","apply","Button","large","border","svg","margin","PauseButton","faPauseCircle","RecordButton","disabled","countdown","faCircleNotch","faCircle","spin","transform","ResumeButton","faPlayCircle","StopButton","faStopCircle","Clock","time","last","stopTimer","setState","timerID","setInterval","tick","timerId","clearInterval","prevProps","recordingState","startTimer","resumeTimer","duration","timeArr","content","unit","join","Component","RecordingState","visibility","FormField","children","RecordingPreview","style","target","maxHeight","onCanPlay","currentTime","SaveCreationDialog","handleInputChange","event","checked","setRecordingData","recordingData","onChange","presenter","overflowY","desktopRecording","videoRecording","button","minWidth","ml","mr","handleUpload","faUpload","handleSave","faDownload","faTrash","getDownloadName","RecordingControls","showModal","desktopRecorder","videoRecorder","handleDialogClose","handlePause","handleResume","handleSaveCreationSave","handleSaveCreationUpload","handleRecord","handleStop","on","getTracks","hasStreams","record","resetRecordings","hide","loading","hideAfter","loginAndUpload","success","info","m","hasRecording","onBeforeunload","preventDefault","open","onClose","ariaLabelledBy","closeOnEsc","closeOnOverlayClick","withTranslation","Icon","Toolbar","paddingRight","marginLeft","faCog","paddingLeft","faExclamationCircle","faQuestionCircle","Warnings","usingUnsecureConnection","location","protocol","hostname","Fragment","defaultRecordingData","Studio","SETTINGS_KEY","ConnectedRoute","render","App","initialValue","React","JSON","parse","localStorage","getItem","setValue","setItem","stringify","useLocalStorage","initial","updateSettings","basename","minHeight","flexGrow","path","exact","prevState"],"mappings":"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","file":"static/js/4.f6c74014.chunk.js","sourcesContent":["const defaultSettings = {\n  serverUrl: 'https://develop.opencast.org/',\n  workflowId: 'fast',\n  loginName: 'admin',\n  loginPassword: 'opencast',\n  connected: false\n};\n\nexport default defaultSettings;\n","//; -*- mode: rjsx;-*-\n/** @jsx jsx */\nimport { jsx, Styled } from 'theme-ui';\nimport { Box } from '@theme-ui/components';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faGlobeEurope, faEnvelope, faPhone } from '@fortawesome/free-solid-svg-icons';\nimport { Link } from 'react-router-dom';\n\nconst Container = props => <Box sx={{ maxWidth: 960, mx: 'auto', px: 3 }} {...props} />;\n\nconst Code = props => (\n  <Box\n    sx={{\n      background: 'gray.2',\n      color: 'gray.1',\n      borderWidth: 1,\n      borderStyle: 'solid',\n      borderColor: 'gray.2',\n      borderLeftWidth: 3,\n      borderLeftColor: 'primary',\n      fontFamily: 'monospace',\n      lineHeight: 'body',\n      my: 3,\n      px: 3,\n      py: 2,\n      maxWidth: '100%',\n      overflow: 'auto',\n      pageBreakInside: 'avoid',\n      wordWrap: 'break-word'\n    }}\n    {...props}\n  />\n);\n\nfunction Impressum() {\n  return (\n    <article>\n      <Styled.h2>ELAN e.V.</Styled.h2>\n\n      <Styled.p>\n        The e-learning academic network (ELAN e.V.) is a German non-profit organization supporting\n        higher-education organizations in all matters related to e-learning. Our services include\n        practical tips about how to use digital technologies in education, legal advice and\n        development of free, open-source software to support education.\n      </Styled.p>\n\n      <Styled.h3>Contact</Styled.h3>\n\n      <Styled.p>\n        Dr. Norbert Kleinefeld, Geschäftsführer\n        <br />\n        Karlstr. 23\n        <br />\n        D-26123 Oldenburg\n      </Styled.p>\n\n      <Styled.p>\n        <FontAwesomeIcon icon={faGlobeEurope} />{' '}\n        <Styled.a href=\"https://elan-ev.de\">elan-ev.de</Styled.a>\n        <br />\n        <FontAwesomeIcon icon={faEnvelope} />{' '}\n        <Styled.a href=\"mailto:kontakt@elan-ev.de\">kontakt@elan-ev.de</Styled.a>\n        <br />\n        <FontAwesomeIcon icon={faPhone} />{' '}\n        <Styled.a href=\"tel:+4944199866610\">+49&thinsp;441 998&thinsp;666&thinsp;10</Styled.a>\n      </Styled.p>\n\n      <Styled.p>\n        Registergericht: Amtsgericht Oldenburg\n        <br />\n        Registernummer: VR 200644\n        <br />\n        USt.-ID-Nr.: DE 265901392\n      </Styled.p>\n    </article>\n  );\n}\n\nfunction About(props) {\n  return (\n    <Container className={props.className}>\n      <article>\n        <header>\n          <Styled.h1>Opencast Studio</Styled.h1>\n        </header>\n        <Styled.p>\n          A web-based recording studio for <Styled.a href=\"https://opencast.org\">Opencast</Styled.a>\n          .\n        </Styled.p>\n        <Styled.p>\n          This is free software under the terms of the{' '}\n          <Styled.a href=\"https://github.com/elan-ev/opencast-studio/blob/master/LICENSE\">\n            MIT License\n          </Styled.a>{' '}\n          developed by the <Styled.a href=\"https://elan-ev.de\">ELAN e.V.</Styled.a> in cooperation\n          with the <Styled.a href=\"https://ethz.ch\">ETH Zürich</Styled.a>.\n          {\" Please report bugs or submit new features on the project's \"}\n          <Styled.a href=\"https://github.com/elan-ev/opencast-studio\">GitHub page</Styled.a>.\n        </Styled.p>\n        <Styled.p>\n          If you are interested in additional development or integrations into specific tools (e.g.\n          LMS), please contact{' '}\n          <Styled.a href=\"mailto:opencast-support@elan-ev.de\">opencast-support@elan-ev.de</Styled.a>\n          .\n        </Styled.p>\n        <Styled.h2>How it works</Styled.h2>\n        <Styled.p>\n          {`Opencast Studio uses the recording capabilities build into browsers to record audio and video streams.\n            The recording happens in the user's browser.\n            No server is involved in the recording.\n            Finally, the recording is transferred directly from the users browser to the target Opencast.`}\n        </Styled.p>\n        <Styled.h2>Allow Studio to interact with your Opencast</Styled.h2>\n        <Styled.p>\n          For Studio to work with your Opencast, your need to allow this on your Opencast by serving\n          a special HTTP header. The mechanism used is called{' '}\n          <Styled.a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS\">\n            Cross-Origin Resource Sharing\n          </Styled.a>\n          .\n        </Styled.p>\n        <Styled.p>\n          {\"Here is a list of the required headers in Nginx's configuration format:\"}\n        </Styled.p>\n        <Code>\n          # Basic open CORS for studio.opencast.org\n          <br />\n          add_header Access-Control-Allow-Origin https://studio.opencast.org;\n          <br />\n          {\"add_header Access-Control-Allow-Methods 'GET, POST';\"}\n          <br />\n          add_header Access-Control-Allow-Credentials true;\n          <br />\n          {\"add_header Access-Control-Allow-Headers 'Origin,Content-Type,Accept,Authorization';\"}\n        </Code>\n        <Styled.p>\n          For a complete configuration file, take a look at the{' '}\n          <Styled.a href=\"https://github.com/opencast/opencast-project-infrastructure/blob/9f09638e922d623cd4d3c91dd90aca39c421530d/ansible-allinone-demo-vm/roles/nginx/templates/nginx.conf#L158-L162\">\n            test server configuration\n          </Styled.a>\n          .\n        </Styled.p>\n\n        <Styled.h2>Credits</Styled.h2>\n        <Styled.p>\n          Thanks to the following people and institutions for contributing to this project:\n        </Styled.p>\n        <ul>\n          <li>\n            <Styled.a href=\"https://github.com/slampunk\">Duncan Smith</Styled.a> for starting this\n            project\n          </li>\n          <li>\n            <Styled.a href=\"https://github.com/cilt-uct\">University of Cape Town (CILT)</Styled.a>\n            {' '}for letting Duncan start the project\n          </li>\n          <li>\n            <Styled.a href=\"https://ethz.ch\">ETH Zürich</Styled.a> for financial support and\n            testing\n          </li>\n          <li>\n            <Styled.a href=\"https://github.com/elan-ev\">ELAN e.V.</Styled.a> for the final\n            development\n          </li>\n        </ul>\n\n        <Impressum />\n\n        <Styled.h2>Version</Styled.h2>\n        <Styled.p>\n          Build date {process.env.REACT_APP_BUILD_DATE || '?'},\n          commit{' '}\n          <Styled.a\n            aria-label=\"Git commit on GitHub\"\n            href={\"https://github.com/elan-ev/opencast-studio/commit/\"\n                  + process.env.REACT_APP_GIT_SHA }\n            >\n            {process.env.REACT_APP_GIT_SHA || '?'}\n          </Styled.a>.\n        </Styled.p>\n\n        <Box as=\"footer\" sx={{ py: 3, textAlign: 'center' }}>\n          <Link sx={{ variant: 'styles.a' }} to=\"/\">\n            ← Back to the Studio\n          </Link>\n        </Box>\n      </article>\n    </Container>\n  );\n}\n\nexport default About;\n","//; -*- mode: rjsx;-*-\n/** @jsx jsx */\nimport { jsx } from 'theme-ui';\n\nimport { Link } from 'react-router-dom';\n\nconst BetaBubble = props => (\n  <span\n    sx={{\n      position: 'relative',\n      top: '4px',\n      fontSize: '12pt',\n      verticalAlign: 'top',\n      display: ['none', 'inline'],\n      borderWidth: 1,\n      borderStyle: 'solid',\n      borderColor: 'gray.2',\n      borderRadius: 5,\n      padding: '2px',\n      color: 'gray.2'\n    }}\n    {...props}\n  />\n);\n\nfunction Brand() {\n  return (\n    <span>\n      <Link to=\"/\">\n        <picture>\n          <source\n            media=\"(min-width: 769px)\"\n            srcSet={`${process.env.PUBLIC_URL}/opencast-studio.svg`}\n          />\n          <img\n            src={`${process.env.PUBLIC_URL}/opencast-studio-small.svg`}\n            alt=\"Opencast Studio\"\n            sx={{ height: 50 }}\n          />\n        </picture>\n      </Link>\n\n      <BetaBubble>beta</BetaBubble>\n    </span>\n  );\n}\n\nfunction OpencastHeader() {\n  return (\n    <header\n      sx={{\n        height: '3rem',\n        lineHeight: '3rem',\n        backgroundColor: 'gray.0',\n        color: 'background',\n        display: 'flex',\n        justifyContent: 'space-between'\n      }}\n    >\n      <Brand />\n    </header>\n  );\n}\n\nexport default OpencastHeader;\n","const languages = [\n  { short: 'en', long: 'English', rtl: false },\n  { short: 'de', long: 'Deutsch', rtl: false },\n  { short: 'el', long: 'Ελληνικά', rtl: false },\n  { short: 'es', long: 'Español', rtl: false },\n  { short: 'fa', long: 'Farsi', rtl: true },\n  { short: 'fr', long: 'Français', rtl: false }\n];\n\nexport default languages;\n","//; -*- mode: rjsx;-*-\n/** @jsx jsx */\nimport { jsx } from 'theme-ui';\nimport { useTranslation } from 'react-i18next';\n\nimport languages from '../languages';\n\nconst LanguagesSelect = () => {\n  const { i18n } = useTranslation();\n\n  return (\n    <select sx={{ variant: 'styles.select' }} defaultValue={i18n.language} >\n      {languages.map(language => (\n        <option\n          onClick={i18n.changeLanguage.bind(i18n, language.short)}\n          value={language.short}\n          key={language.short}\n        >\n          {language.long}\n        </option>\n      ))}\n    </select>\n  );\n};\n\nexport default LanguagesSelect;\n","//; -*- mode: rjsx;-*-\n/** @jsx jsx */\nimport { jsx } from 'theme-ui';\n\nconst Notification = ({isDanger, ...rest}) => (\n  <div\n    sx={{\n      ':not(:last-child)': { marginBottom: '1.5rem' },\n      backgroundColor: isDanger ? 'error' : 'gray.3',\n      color: isDanger ? 'background' : 'currentColor',\n      borderRadius: 2,\n      padding: 3,\n      position: 'relative'\n    }}\n    {...rest}\n  />\n);\n\nexport default Notification;\n","import axios from 'axios';\n\nclass OpencastAPI {\n  constructor(settings) {\n    this.server_url = settings.serverUrl.endsWith('/')\n      ? settings.serverUrl.slice(0, -1)\n      : settings.serverUrl;\n    this.workflow_id = settings.workflowId;\n\n    this.username = settings.loginName;\n    this.password = settings.loginPassword;\n  }\n\n  async checkConnection() {\n    try {\n      await this.login();\n      return !!(await this.validateState());\n    } catch (error) {\n      return false;\n    }\n  }\n\n  async loginAndUpload(\n    recordings,\n    onsuccess,\n    onloginfailed,\n    onserverunreachable,\n    oninetorpermfailed,\n    title,\n    creator\n  ) {\n    // relog needed?\n    let isLoggedIn = true;\n    try {\n      isLoggedIn = await this.validateState();\n    } catch (e) {\n      onserverunreachable(e);\n      return;\n    }\n\n    if (!isLoggedIn) {\n      await this.login();\n    }\n\n    this.uploadFromRecordings(\n      recordings,\n      onsuccess,\n      onloginfailed,\n      onserverunreachable,\n      oninetorpermfailed,\n      title,\n      creator\n    );\n  }\n\n  async uploadFromRecordings(\n    recordings,\n    onsuccess,\n    onnotloggedin,\n    onserverunreachable,\n    oninetorpermfailed,\n    title,\n    creator\n  ) {\n    // check Connection State\n    try {\n      let isLoggedIn = await this.validateState();\n      if (!isLoggedIn) {\n        onnotloggedin();\n        return;\n      }\n    } catch (e) {\n      onserverunreachable(e);\n      return;\n    }\n\n    try {\n      let mp = await this.getMediaPackage().then(mp => {\n        let base_dc = `<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n          <dublincore xmlns=\"http://www.opencastproject.org/xsd/1.0/dublincore/\"\n                      xmlns:dcterms=\"http://purl.org/dc/terms/\"\n                      xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\">\n              <dcterms:created xsi:type=\"dcterms:W3CDTF\">2001-01-01T01:01Z</dcterms:created>\n              <dcterms:creator>Creator not set</dcterms:creator>\n              <dcterms:extent xsi:type=\"dcterms:ISO8601\">PT5.568S</dcterms:extent>\n              <dcterms:title>Title Not Set</dcterms:title>\n              <dcterms:spatial>Opencast Studio</dcterms:spatial>\n          </dublincore>`;\n\n        const dc = new DOMParser().parseFromString(base_dc, 'text/xml');\n        const dc_created = dc.getElementsByTagName('dcterms:created');\n        const dc_creator = dc.getElementsByTagName('dcterms:creator');\n        const dc_title = dc.getElementsByTagName('dcterms:title');\n\n        dc_created[0].textContent = new Date(Date.now()).toISOString();\n        dc_creator[0].textContent = creator;\n        dc_title[0].textContent = title;\n\n        return this.addDCCatalog(\n          mp.data,\n          new XMLSerializer().serializeToString(dc),\n          'dublincore/episode'\n        );\n      });\n\n      for (const { deviceType, media } of recordings.filter(Boolean)) {\n        let trackFlavor = 'presentation/source';\n        if (deviceType === 'desktop') {\n          trackFlavor = 'presentation/source';\n        } else if (deviceType === 'video') {\n          trackFlavor = 'presenter/source';\n        }\n\n        // TODO(mel)\n        const type = 'video';\n\n        const flavor = deviceType === 'desktop' ? 'Presentation' : 'Presenter';\n        const downloadName = `${flavor} ${type} - ${title || 'Recording'}.webm`;\n\n        mp = await this.addTrack(mp.data, media, downloadName, trackFlavor, '');\n      }\n\n      await this.ingest(mp.data, this.workflow_id);\n    } catch (err) {\n      // Inet failed (while transmitting) or not enough permission\n      oninetorpermfailed(err);\n      return;\n    }\n\n    onsuccess();\n  }\n\n  async validateState() {\n    const me_info_json = await this.getMeInfo();\n    const me_info = me_info_json.data;\n\n    return me_info['user']['username'] !== 'anonymous';\n    // OnError: Couldn't connect to server: inet failed / is not a Opencast Api / CORS not allowed\n  }\n\n  login() {\n    const data = `j_username=${this.username}&j_password=${this.password}&_spring_security_remember_me=on`;\n    const url = `${this.server_url}/admin_ng/j_spring_security_check`;\n    return axios({ url, method: 'post', data, withCredentials: true });\n  }\n\n  getMeInfo() {\n    const url = `${this.server_url}/info/me.json`;\n    return axios.get(url, { responseType: 'text', withCredentials: true });\n  }\n\n  getMediaPackage() {\n    const url = `${this.server_url}/ingest/createMediaPackage`;\n    return axios.get(url, { responseType: 'text', withCredentials: true });\n  }\n\n  addDCCatalog(mp, dc, flavor) {\n    const data = new FormData();\n    data.append('mediaPackage', mp);\n    data.append('dublinCore', dc);\n    data.append('flavor', flavor);\n\n    const url = `${this.server_url}/ingest/addDCCatalog`;\n    return axios({ url, method: 'post', data, responseType: 'text', withCredentials: true });\n  }\n\n  addTrack(mp, track, track_filename, flavor, tags) {\n    const data = new FormData();\n    data.append('mediaPackage', mp);\n    data.append('flavor', flavor);\n    data.append('tags', tags);\n    data.append('BODY', track, track_filename);\n    const url = `${this.server_url}/ingest/addTrack`;\n\n    return axios({ url, method: 'post', data, responseType: 'text', withCredentials: true });\n  }\n\n  ingest(mp, workflowId) {\n    const data = new FormData();\n    data.append('mediaPackage', mp);\n    data.append('workflowDefinitionId', workflowId);\n    const url = `${this.server_url}/ingest/ingest`;\n\n    return axios({ url, method: 'post', data, responseType: 'text', withCredentials: true });\n  }\n}\n\nexport default OpencastAPI;\n","//; -*- mode: rjsx;-*-\n/** @jsx jsx */\nimport { jsx } from 'theme-ui';\n\nimport { useTranslation } from 'react-i18next';\nimport useForm from 'react-hook-form';\nimport { Box, Button } from '@theme-ui/components';\n\nconst Input = ({ errors, label, name, register, required, type = 'text', ...rest }) => {\n  const { t } = useTranslation();\n\n  return (\n    <div\n      sx={{\n        '&:not(:last-child)': {\n          mb: 3\n        }\n      }}\n    >\n      <label\n        sx={{\n          color: 'text',\n          display: 'block',\n          fontSize: 2,\n          fontWeight: 'bold'\n        }}\n      >\n        {label}\n        <div\n          sx={{\n            display: 'block',\n            boxSizing: 'border-box',\n            clear: 'both',\n            fontSize: 2,\n            position: 'relative',\n            textAlign: 'left'\n          }}\n        >\n          <input\n            aria-invalid={errors[name] ? 'true' : 'false'}\n            aria-describedby={`${name}Error`}\n            autoComplete=\"off\"\n            name={name}\n            ref={register({ required })}\n            sx={{ variant: 'styles.input' }}\n            type={type}\n            {...rest}\n          />\n          {errors[name] && (\n            <p\n              id={`${name}Error`}\n              sx={{\n                color: 'error',\n                fontSize: 1,\n                fontWeight: 'body',\n                mt: 1\n              }}\n            >\n              {t('forms-validation-error-required')}\n            </p>\n          )}\n        </div>\n      </label>\n    </div>\n  );\n};\n\nfunction SettingsForm(props) {\n  const { t } = useTranslation();\n  const { errors, handleSubmit, register, reset } = useForm({\n    defaultValues: props.settings\n  });\n\n  const onSubmit = data => {\n    props.handleSubmit(data);\n  };\n\n  const onCancel = data => {\n    reset();\n    props.handleCancel(data);\n  };\n\n  return (\n    <Box sx={{ maxWidth: 960, mx: 'auto' }}>\n      <form onSubmit={handleSubmit(onSubmit)}>\n        <Input\n          errors={errors}\n          label={t('upload-settings-label-server-url')}\n          name=\"serverUrl\"\n          register={register}\n          required\n        />\n\n        <Input\n          errors={errors}\n          label={t('upload-settings-label-workflow-id')}\n          name=\"workflowId\"\n          register={register}\n          required\n        />\n\n        <Input\n          errors={errors}\n          label={t('upload-settings-label-username')}\n          name=\"loginName\"\n          register={register}\n          required\n        />\n\n        <Input\n          errors={errors}\n          label={t('upload-settings-label-password')}\n          name=\"loginPassword\"\n          register={register}\n          required\n          type=\"password\"\n        />\n\n        <footer sx={{ mt: 4 }}>\n          <Button>{t('upload-settings-button-store')}</Button>\n          {props.settings.connected && (\n            <Button variant=\"text\" onClick={onCancel}>\n              {t('cancel-button-title')}\n            </Button>\n          )}\n        </footer>\n      </form>\n    </Box>\n  );\n}\n\nexport default SettingsForm;\n","//; -*- mode: rjsx;-*-\n/** @jsx jsx */\nimport { jsx } from 'theme-ui';\n\nimport { useState } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { useHistory, useLocation } from 'react-router-dom';\nimport { Box } from '@theme-ui/components';\n\nimport LanguagesSelect from './languages-select';\nimport Notification from './notification';\nimport OpencastAPI from '../opencast-api';\nimport SettingsForm from './settings-form';\n\nfunction Settings(props) {\n  const { t } = useTranslation();\n  const [error, setError] = useState();\n  const history = useHistory();\n  const location = useLocation();\n  const { from } = location.state || { from: { pathname: '/' } };\n\n  function returnToTheStudio() {\n    history.replace(from);\n  }\n\n  async function handleSubmit(data) {\n    try {\n      const ocUploader = new OpencastAPI({ ...data });\n      const connected = await ocUploader.checkConnection();\n      if (!connected) {\n        setError(t('upload-settings-validation-error'));\n        return;\n      }\n      props.handleUpdate(data);\n      returnToTheStudio();\n    } catch (error) {\n      setError(t('message-server-unreachable'));\n      console.log(error);\n    }\n  }\n\n  return (\n    <Box sx={{ maxWidth: 960, mx: 'auto', px: 3, pb: 3 }}>\n      <header>\n        <h1>{t('settings-header')}</h1>\n      </header>\n\n      <label sx={{ fontWeight: 'bold' }}>Language</label>\n      <LanguagesSelect />\n\n      <h2 sx={{ fontWeight: 'heading' }}>{t('upload-settings-modal-header')}</h2>\n      <main>\n        {error && <Notification isDanger>{error}</Notification>}\n\n        {!props.settings.connected && <Notification>{t('settings-first-run')}</Notification>}\n\n        <SettingsForm\n          settings={props.settings}\n          handleSubmit={handleSubmit}\n          handleCancel={returnToTheStudio}\n        />\n      </main>\n    </Box>\n  );\n}\n\nexport default Settings;\n","//; -*- mode: rjsx;-*-\n/** @jsx jsx */\nimport { jsx } from 'theme-ui';\n\nimport { Fragment, useEffect, useRef } from 'react';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\n\nfunction MediaDevice({ onClick, title, icon, stream }) {\n  const videoRef = useRef();\n  useEffect(() => {\n    if (videoRef.current && typeof stream != 'undefined') {\n      videoRef.current.srcObject = stream;\n    }\n  });\n  return (\n    <div\n      onClick={stream ? null : onClick}\n      data-title={title}\n      sx={{\n        backgroundColor: 'gray.3',\n        boxShadow: '0 2px 2px rgba(0, 0, 0, 0.35)',\n        overflow: 'hidden',\n        zIndex: '0',\n        cursor: stream ? 'initial' : 'pointer',\n        position: 'relative',\n\n        display: 'flex',\n        flexDirection: 'column',\n        alignItems: 'center'\n      }}\n    >\n      <video\n        ref={videoRef}\n        autoPlay\n        muted\n        sx={{\n          outline: 'none',\n          position: 'absolute',\n          top: 0,\n          left: 0,\n          width: '100%',\n          height: '100%',\n          zIndex: 2,\n          background: 'transparent'\n        }}\n      ></video>\n      {!stream && (\n        <Fragment>\n          <span\n            sx={{\n              flex: '1 0 auto',\n              display: 'flex',\n              alignItems: 'center',\n              justifyContent: 'center',\n              color: 'white'\n            }}\n          >\n          <FontAwesomeIcon icon={icon} sx={{ fontSize: [6, 7, 8] }} />\n          </span>\n          <p sx={{ color: 'gray.1', fontSize: 4, fontWeight: 'heading' }}>{title}</p>\n        </Fragment>\n      )}\n    </div>\n  );\n}\n\nexport default MediaDevice;\n","// Checks if we app is running on a mobile device.\n//\n// This check could be more exhaustive, but this includes all browser we\n// officially support.\nexport const onMobileDevice = () =>\n  /Android|iPhone|iPad|iPod/i.test(navigator.platform) ||\n  /Android/i.test(navigator.userAgent);\n\n// Checks if the client supports capturing the device's display (or individual\n// windows).\n//\n// Detecting whether display capture is supported is hard. There is currently\n// no proper solution. See these two links for more information:\n// - https://stackoverflow.com/q/58842831/2408867\n// - https://github.com/w3c/mediacapture-screen-share/issues/127\n//\n// To work around this problem, we simply check if the browser runs on a\n// mobile device. Currently, no mobile device/browser supports display\n// capture. However, this will probably change in the future, so we have to\n// revisit this issue again. This is tracked in this issue:\n// https://github.com/elan-ev/opencast-studio/issues/204\nexport const isDisplayCaptureSupported = () =>\n  \"mediaDevices\" in navigator &&\n  \"getDisplayMedia\" in navigator.mediaDevices &&\n  !onMobileDevice();\n\n// Checks if the client supports capturing \"user devices\" (usually webcams or\n// phone cameras).\nexport const isUserCaptureSupported = () =>\n  'mediaDevices' in navigator && 'getUserMedia' in navigator.mediaDevices;\n\n// Checks if the browsers supports the `MediaRecorder` API required to actually\n// record the media streams.\nexport const isRecordingSupported = () => typeof(MediaRecorder) !== 'undefined';\n\n// Checks if this runs in Safari.\nexport const onSafari = () => /Safari/i.test(navigator.userAgent);\n","//; -*- mode: rjsx;-*-\n/** @jsx jsx */\nimport { jsx } from 'theme-ui';\n\nimport toast from 'cogo-toast';\nimport { faDesktop, faVideo } from '@fortawesome/free-solid-svg-icons';\nimport { useTranslation } from 'react-i18next';\nimport MediaDevice from './media-device';\nimport {\n  isDisplayCaptureSupported,\n  isUserCaptureSupported,\n} from \"../util\";\nimport Notification from './notification';\n\nfunction startDisplayCapture(displayMediaOptions) {\n  return navigator.mediaDevices.getDisplayMedia(displayMediaOptions).catch(err => {\n    console.error('Error:' + err);\n    toast.error('Your browser does not permit to capture the screen.');\n    return null;\n  });\n}\n\nfunction startUserCapture(userMediaOptions) {\n  const userMediaPromise = navigator.mediaDevices.getUserMedia(userMediaOptions);\n\n  return userMediaPromise.catch(err => {\n    console.error('Error:' + err);\n    toast.error('Your browser does not permit to capture your webcam.');\n    return null;\n  });\n}\n\nfunction MediaDevices(props) {\n  const { t } = useTranslation();\n\n  function requestDisplayMedia() {\n    startDisplayCapture({ video: true, audio: true }).then(desktopStream => {\n      props.setDesktopStream(desktopStream);\n    });\n  }\n\n  function requestUserMedia() {\n    startUserCapture({\n      audio: true,\n      video: {\n        width: { ideal: 1280, max: 1920 },\n        height: { ideal: 720, max: 1080 }\n      }\n    }).then(videoStream => {\n      props.setVideoStream(videoStream);\n    });\n  }\n\n  return (\n    <div\n      sx={{\n        flex: 1,\n        display: 'flex',\n        flexDirection: ['column', 'row'],\n        justifyContent: 'center',\n        flexWrap: 'wrap',\n        '& > *': {\n          flex: '1 0 50%'\n        }\n      }}\n    >\n      {isDisplayCaptureSupported() && (\n        <MediaDevice\n          onClick={requestDisplayMedia}\n          title={t('share-desktop')}\n          icon={faDesktop}\n          stream={props.desktopStream}\n        />\n      )}\n\n      {isUserCaptureSupported() && (\n        <MediaDevice\n          onClick={requestUserMedia}\n          title={t('share-camera')}\n          icon={faVideo}\n          stream={props.videoStream}\n        />\n      )}\n\n      {!isDisplayCaptureSupported() && !isUserCaptureSupported() && (\n        <div sx={{ p: 3 }}>\n          <Notification isDanger>\n            Your browser does not allow capturing your display or any other media input.\n          </Notification>\n        </div>\n      )}\n    </div>\n  );\n}\n\nexport default MediaDevices;\n","function click(node) {\n  try {\n    node.dispatchEvent(new MouseEvent('click'));\n  } catch (e) {\n    var evt = document.createEvent('MouseEvents');\n    evt.initMouseEvent(\n      'click',\n      true,\n      true,\n      window,\n      0,\n      0,\n      0,\n      80,\n      20,\n      false,\n      false,\n      false,\n      false,\n      0,\n      null\n    );\n    node.dispatchEvent(evt);\n  }\n}\n\nfunction downloadBlob(blob, name) {\n  var a = document.createElement('a');\n  a.download = name;\n  a.rel = 'noopener'; // tabnabbing\n  a.href = URL.createObjectURL(blob);\n  setTimeout(function() {\n    URL.revokeObjectURL(a.href);\n  }, 4e4); // 40s\n  setTimeout(function() {\n    click(a);\n  }, 0);\n}\n\nexport default downloadBlob;\n","import EventEmitter from './event-emitter';\n\nconst findSupportedMimeType = list =>\n  MediaRecorder && 'isTypeSupported' in MediaRecorder\n    ? list.find(mimeType => MediaRecorder.isTypeSupported(mimeType)) || ''\n    : '';\n\nclass Recorder extends EventEmitter {\n  constructor(stream, mimeType) {\n    super();\n\n    if (!mimeType) {\n      mimeType = stream.getVideoTracks().length\n        ? findSupportedMimeType([\n            'video/webm;codecs=\"vp9,opus\"',\n            'video/webm;codecs=\"vp9.0,opus\"',\n            'video/webm;codecs=\"avc1\"',\n            'video/x-matroska;codecs=\"avc1\"',\n            'video/webm;codecs=\"vp8,opus\"'\n          ])\n        : findSupportedMimeType(['audio/ogg;codecs=opus', 'audio/webm;codecs=opus']);\n    }\n\n    const _recData = [];\n    this.recorder = new MediaRecorder(stream, { mimeType });\n    this.recorder.ondataavailable = function(e) {\n      if (e.data.size > 0) {\n        _recData.push(e.data);\n      }\n    };\n\n    this.recorder.onerror = error => {\n      this.emit('record.error', error);\n    };\n\n    this.recorder.onstart = () => {\n      this.emit('record.start', true);\n    };\n\n    this.result = null;\n\n    this.recorder.onstop = () => {\n      let mimeType = (this.deviceType === 'audio' ? 'audio' : 'video') + '/webm';\n      this.result = new Blob(_recData, { type: mimeType });\n      let url = URL.createObjectURL(this.result);\n      this.emit('record.complete', { url: url, media: this.result });\n      this.recorder = null;\n    };\n\n    Object.defineProperty(this, 'recData', {\n      get: function() {\n        return _recData;\n      }\n    });\n\n    this.isRecording = false;\n    this.isPaused = false;\n  }\n\n  start(delay) {\n    delay = delay || 0;\n    if (!this.isRecording) {\n      setTimeout(() => {\n        this.recorder.start();\n      }, delay);\n      this.isRecording = true;\n    } else if (this.isPaused) {\n      this.resume();\n    }\n  }\n\n  pause() {\n    if (!this.isPaused) {\n      this.recorder.pause();\n    } else {\n      this.resume();\n    }\n    this.isPaused = !this.isPaused;\n  }\n\n  resume() {\n    if (this.recorder.state === 'paused') {\n      this.recorder.resume();\n    }\n  }\n\n  stop() {\n    this.recorder.stop();\n    this.isRecording = false;\n  }\n}\n\nexport default Recorder;\n","class EventEmitter {\n  constructor() {\n    let _completeFns = {};\n    let _onceFns = {};\n\n    Object.defineProperty(this, \"completeFns\", {\n      get: function() {\n        return _completeFns;\n      }\n    });\n\n    Object.defineProperty(this, \"onceFns\", {\n      get: function() {\n        return _onceFns;\n      }\n    });\n  }\n\n  on(ev, fnObj) {\n    if (!this.completeFns[ev]) {\n      this.completeFns[ev] = {};\n    }\n\n    let token = null;\n    do {\n      token = (Math.random() + 1).toString(36).substring(2, 10);\n    } while (Object.keys(this.completeFns).indexOf(token) > -1);\n\n    fnObj = typeof fnObj === \"function\" ? { fn: fnObj, scope: null } : fnObj;\n    this.completeFns[ev][token] = {\n      scope: fnObj.scope,\n      fn: fnObj.fn\n    };\n\n    return token;\n  }\n\n  once(ev, fnObj) {\n    if (!this.onceFns[ev]) {\n      this.onceFns[ev] = {};\n    }\n\n    let token = null;\n    do {\n      token = (Math.random() + 1).toString(36).substring(2, 10);\n    } while (Object.keys(this.completeFns).indexOf(token) > -1);\n\n    fnObj = typeof fnObj === \"function\" ? { fn: fnObj, scope: null } : fnObj;\n    this.onceFns[ev][token] = {\n      scope: fnObj.scope,\n      fn: fnObj.fn\n    };\n  }\n\n  off(ev, token) {\n    if (!ev || !token) {\n      return false;\n    }\n\n    if (this.completeFns[ev] && this.completeFns[ev][token]) {\n      delete this.completeFns[ev][token];\n      return true;\n    }\n\n    return false;\n  }\n\n  emit(ev, val) {\n    let args = Array.prototype.slice.call(arguments);\n    ev = args[0];\n    val = args.slice(1);\n    [\"completeFns\", \"onceFns\"].forEach(fnType => {\n      if (this[fnType][ev]) {\n        Object.keys(this[fnType][ev]).forEach(key => {\n          let scope = this[fnType][ev][key].scope;\n          let fn = this[fnType][ev][key].fn;\n          fn.apply(scope, val);\n        });\n      }\n    });\n\n    if (this.onceFns[ev]) {\n      delete this.onceFns[ev];\n    }\n  }\n}\n\nexport default EventEmitter;\n","//; -*- mode: rjsx;-*-\n/** @jsx jsx */\nimport { jsx } from 'theme-ui';\n\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport {\n  faCircle,\n  faCircleNotch,\n  faPauseCircle,\n  faPlayCircle,\n  faStopCircle\n} from '@fortawesome/free-solid-svg-icons';\n\nconst Button = ({ large, ...rest }) => (\n  <button\n    sx={{\n      backgroundColor: 'transparent',\n      border: 'none',\n      position: 'relative',\n      my: 0,\n      mx: large ? '1rem' : '0.5rem',\n      padding: large ? '0.5rem' : '0.25rem',\n      fontSize: large ? '5rem' : '2.5rem',\n      lineHeight: large ? '5rem' : '2.5rem',\n      svg: {\n        margin: 0,\n        padding: 0,\n        outline: 'none'\n      }\n    }}\n    {...rest}\n  />\n);\n\nexport const PauseButton = props => (\n  <Button onClick={props.onClick} title={props.title}>\n    <span className=\"fa-layers fa-fw\">\n      <FontAwesomeIcon icon={faPauseCircle} />\n    </span>\n  </Button>\n);\n\nexport const RecordButton = props => (\n  <Button\n    onClick={props.onClick}\n    title={props.title}\n    large={props.large ? 1 : 0}\n    disabled={props.disabled || props.countdown}\n    sx={{\n      color: '#bd181c',\n      'svg + svg': { color: '#e22319' },\n      ':disabled': { color: '#aaa' },\n      ':disabled svg + svg': { color: '#bbb' }\n    }}\n  >\n    <span className=\"fa-layers fa-fw\">\n      <FontAwesomeIcon icon={props.countdown ? faCircleNotch : faCircle} spin={props.countdown} />\n      <FontAwesomeIcon icon={faCircle} transform=\"shrink-6\" />\n    </span>\n  </Button>\n);\n\nexport const ResumeButton = props => (\n  <Button onClick={props.onClick} title={props.title}>\n    <span className=\"fa-layers fa-fw\">\n      <FontAwesomeIcon icon={faPlayCircle} />\n    </span>\n  </Button>\n);\n\nexport const StopButton = props => (\n  <Button\n    onClick={props.onClick}\n    title={props.title}\n    large={!!props.large}\n    sx={{ color: '#bd181c' }}\n  >\n    <FontAwesomeIcon icon={faStopCircle} />\n  </Button>\n);\n","//; -*- mode: rjsx;-*-\n/** @jsx jsx */\nimport { jsx } from 'theme-ui';\nimport { Component } from 'react';\n\nclass Clock extends Component {\n  constructor(props) {\n    super(props);\n    this.state = { time: 0, last: null };\n  }\n\n  componentWillUnmount() {\n    this.stopTimer();\n  }\n\n  startTimer() {\n    this.setState({ time: 0, last: new Date() });\n    this.timerID = setInterval(() => this.tick(), 10);\n  }\n\n  resumeTimer() {\n    if (!this.timerId) {\n      this.timerID = setInterval(() => this.tick(), 10);\n      this.setState({ last: new Date() });\n    }\n  }\n\n  stopTimer() {\n    clearInterval(this.timerID);\n    this.timerId = null;\n  }\n\n  componentDidUpdate(prevProps) {\n    // recording state did not change\n    if (this.props.recordingState === prevProps.recordingState) {\n      return;\n    }\n\n    if (this.props.recordingState !== 'recording') {\n      this.stopTimer();\n      return;\n    }\n\n    if (prevProps.recordingState === 'inactive') {\n      this.startTimer();\n    } else if (prevProps.recordingState === 'paused') {\n      this.resumeTimer();\n    }\n  }\n\n  tick() {\n    this.setState(state => {\n      const now = new Date();\n      return {\n        time: state.time + (now - state.last),\n        last: now\n      };\n    });\n  }\n\n  render() {\n    const duration = this.state.time;\n    let timeArr = [\n      (duration / 3600000) >> 0,\n      ((duration / 60000) >> 0) % 60,\n      ((duration / 1000) >> 0) % 60\n    ];\n    if (timeArr[0] === 0) {\n      timeArr = timeArr.slice(1);\n    }\n    const content = timeArr.map(unit => (unit < 10 ? '0' : '') + unit).join(':');\n\n    return <span>{content}</span>;\n  }\n}\n\nexport default Clock;\n","//; -*- mode: rjsx;-*-\n/** @jsx jsx */\nimport { jsx } from 'theme-ui';\n\nimport { useTranslation } from 'react-i18next';\nimport Clock from './clock';\n\nconst RecordingState = props => {\n  const { t } = useTranslation();\n  return (\n      <div sx={{ display: \"flex\", alignItems: 'center', visibility: props.recordingState === 'inactive' ? 'hidden' : 'visible' }}>\n      <Clock recordingState={props.recordingState} />\n        <p sx={{ px: 2, color: props.recordingState === 'paused' ? 'gray.1' : 'transparent' }}>\n        {props.recordingState === 'recording'\n          ? t('Recording')\n          : props.recordingState === 'paused'\n          ? t('Paused')\n          : t('Waiting')}\n      </p>\n    </div>\n  );\n};\n\nexport default RecordingState;\n","//; -*- mode: rjsx;-*-\n/** @jsx jsx */\nimport { jsx } from 'theme-ui';\n\nfunction FormField(props) {\n  return (\n    <div\n      sx={{\n        '&:not(:last-child)': {\n          marginBottom: 3\n        }\n      }}\n    >\n      <label\n        sx={{\n          color: 'gray.0',\n          display: 'block',\n          fontSize: 2,\n          fontWeight: 'bold'\n        }}\n      >\n        {props.label}\n        <div\n          sx={{\n            boxSizing: 'border-box',\n            clear: 'both',\n            fontSize: 2,\n            position: 'relative',\n            textAlign: 'left'\n          }}\n        >\n          {props.children}\n        </div>\n      </label>\n    </div>\n  );\n}\n\nexport default FormField;\n","//; -*- mode: rjsx;-*-\n/** @jsx jsx */\nimport { jsx } from 'theme-ui';\n\nconst RecordingPreview = ({ deviceType, title, type, url }) => {\n  const flavor = deviceType === 'desktop' ? 'Presentation' : 'Presenter';\n  const downloadName = `${flavor} ${type} - ${title || 'Recording'}.webm`;\n\n  const style = {\n    width: '8rem',\n    height: '4.5rem',\n    position: 'relative',\n    backgroundColor: 'gray.3',\n    textAlign: 'center',\n    padding: '0.5rem',\n    margin: '0 0.5rem 0.5rem 0',\n    color: 'transparent'\n  };\n\n  if (!url) {\n    return (\n      <a sx={style} target=\"_blank\" href={url} download={downloadName} rel=\"noopener noreferrer\">\n        {deviceType}\n      </a>\n    );\n  }\n\n  return (\n    <a sx={style} target=\"_blank\" download={downloadName} href={url} rel=\"noopener noreferrer\">\n      {deviceType}\n      <video\n        sx={{\n          position: 'absolute',\n          maxWidth: '100%',\n          maxHeight: '100%',\n          top: '50%',\n          left: '50%',\n          transform: 'translate(-50%, -50%)'\n        }}\n        src={url}\n\n        // Without this, some browsers show a black video element instead of the first frame.\n        onCanPlay={e => e.target.currentTime = 0}\n      ></video>\n    </a>\n  );\n};\n\nexport default RecordingPreview;\n","//; -*- mode: rjsx;-*-\n/** @jsx jsx */\nimport { jsx } from 'theme-ui';\n\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faDownload, faTrash, faUpload } from '@fortawesome/free-solid-svg-icons';\nimport { useState } from 'react';\nimport { useTranslation } from 'react-i18next';\n\nimport { Button } from '@theme-ui/components';\nimport FormField from './form-field';\nimport Notification from './notification';\nimport RecordingPreview from './recording-preview';\n\nconst Input = props => <input sx={{ variant: 'styles.input' }} {...props} />;\n\nfunction SaveCreationDialog(props) {\n  const { t } = useTranslation();\n  const [error, setError] = useState();\n\n  function handleInputChange(event) {\n    const target = event.target;\n    const value = target.type === 'checkbox' ? target.checked : target.value;\n    const name = target.name;\n\n    props.setRecordingData({ ...props.recordingData, [name]: value });\n  }\n\n  // TODO: validation is in props.handleUpload too; it is needed here to show the error in the dialog instead of as a toast\n  function handleUpload() {\n    if (props.recordingData.title === '' || props.recordingData.presenter === '') {\n      setError(t('save-creation-form-invalid'));\n    } else {\n      props.handleUpload();\n    }\n  }\n\n  return (\n    <div\n      sx={{\n        display: 'flex',\n        flexDirection: 'column',\n        justifyContent: 'space-between',\n        height: '100%'\n      }}\n    >\n      <header>\n        <h1 sx={{ fontWeight: 'heading' }}>{t('save-creation-modal-title')}</h1>\n      </header>\n\n      <main sx={{ flex: 1 }}>\n        {error && <Notification isDanger>{error}</Notification>}\n\n        <FormField label={t('save-creation-label-title')}>\n          <Input\n            name=\"title\"\n            autoComplete=\"off\"\n            value={props.recordingData.title}\n            onChange={handleInputChange}\n          />\n        </FormField>\n\n        <FormField label={t('save-creation-label-presenter')}>\n          <Input\n            name=\"presenter\"\n            autoComplete=\"off\"\n            value={props.recordingData.presenter}\n            onChange={handleInputChange}\n          />\n        </FormField>\n      </main>\n\n      <header>\n        <h1 sx={{ fontWeight: 'heading' }}>{t('save-creation-label-media')}</h1>\n      </header>\n\n      <main sx={{ flex: 1 }}>\n        <div\n          sx={{\n            display: 'flex',\n            maxHeight: '6.5rem',\n            overflowY: 'auto',\n            flexWrap: 'wrap'\n          }}\n        >\n          {props.desktopRecording && (\n            <RecordingPreview\n              deviceType=\"desktop\"\n              title={props.recordingData.title}\n              type=\"video\"\n              url={props.desktopRecording.url}\n            />\n          )}\n          {props.videoRecording && (\n            <RecordingPreview\n              deviceType=\"video\"\n              title={props.recordingData.title}\n              type=\"video\"\n              url={props.videoRecording.url}\n            />\n          )}\n        </div>\n      </main>\n\n      <footer\n        sx={{\n          mt: 4,\n          button: {\n            minWidth: 100,\n            width: ['100%', 'auto'],\n            '& + button': {\n              ml: [0, 2],\n              mt: [2, 'auto']\n            },\n            '& svg': {\n              mr: 2\n            }\n          }\n        }}\n      >\n        <Button onClick={handleUpload}>\n          <FontAwesomeIcon icon={faUpload} />\n          <span>{t('save-creation-button-upload')}</span>\n        </Button>\n\n        <Button onClick={props.handleSave}>\n          <FontAwesomeIcon icon={faDownload} />\n          <span>{t('save-creation-button-save')}</span>\n        </Button>\n\n        <Button onClick={props.handleCancel}>\n          <FontAwesomeIcon icon={faTrash} />\n          <span>{t('save-creation-button-discard')}</span>\n        </Button>\n      </footer>\n    </div>\n  );\n}\n\nexport default SaveCreationDialog;\n","//; -*- mode: rjsx;-*-\n/** @jsx jsx */\nimport { jsx } from 'theme-ui';\n\nimport { Component } from 'react';\nimport Modal from 'react-responsive-modal';\nimport { withTranslation } from 'react-i18next';\nimport { Beforeunload } from 'react-beforeunload';\n\nimport toast from 'cogo-toast';\n\nimport downloadBlob from '../download-blob';\nimport OpencastAPI from '../opencast-api';\nimport Recorder from '../recorder';\n\nimport { PauseButton, RecordButton, ResumeButton, StopButton } from './recording-buttons';\nimport RecordingState from './recording-state';\nimport SaveCreationDialog from './save-creation';\n\nconst getDownloadName = (deviceType, type, title) => {\n  const flavor = deviceType === 'desktop' ? 'Presentation' : 'Presenter';\n  return `${flavor} ${type} - ${title || 'Recording'}.webm`;\n};\n\nclass RecordingControls extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      countdown: false,\n      recordingState: 'inactive',\n      showModal: false,\n      desktopRecording: null,\n      videoRecording: null\n    };\n\n    this.desktopRecorder = null;\n    this.videoRecorder = null;\n\n    this.handleDialogClose = this.handleDialogClose.bind(this);\n    this.handlePause = this.handlePause.bind(this);\n    this.handleResume = this.handleResume.bind(this);\n    this.handleSaveCreationSave = this.handleSaveCreationSave.bind(this);\n    this.handleSaveCreationUpload = this.handleSaveCreationUpload.bind(this);\n    this.handleRecord = this.handleRecord.bind(this);\n    this.handleStop = this.handleStop.bind(this);\n  }\n\n  hasRecording() {\n    return this.state.desktopRecording || this.state.videoRecording;\n  }\n\n  hasStreams() {\n    return this.props.desktopStream || this.props.videoStream;\n  }\n\n  record() {\n    const streams = ['desktop', 'video'];\n\n    streams.forEach(deviceType => {\n      const recorder = `${deviceType}Recorder`;\n      const stream = this.props[`${deviceType}Stream`];\n\n      if (!stream) {\n        return;\n      }\n\n      this[recorder] = new Recorder(stream);\n\n      this[recorder].on('record.complete', () => {\n        this[recorder] = null;\n      });\n\n      this[recorder].on('record.complete', ({ media, url }) => {\n        this.setState({ [`${deviceType}Recording`]: { deviceType, media, url } });\n      });\n\n      this[recorder].start();\n    });\n  }\n\n  resume() {\n    const streams = ['desktop', 'video'];\n\n    streams.forEach(deviceType => {\n      const recorder = `${deviceType}Recorder`;\n      this[recorder] && this[recorder].resume();\n    });\n  }\n\n  pause() {\n    this.desktopRecorder && this.desktopRecorder.pause();\n    this.videoRecorder && this.videoRecorder.pause();\n  }\n\n  stop() {\n    const streams = ['desktop', 'video'];\n\n    streams.forEach(type => {\n      if (this[`${type}Recorder`]) {\n        this[`${type}Recorder`].stop();\n        this.props[`${type}Stream`].getTracks().forEach(track => track.stop());\n      }\n    });\n\n    this.setState({ showModal: true });\n  }\n\n  handlePause() {\n    this.setState({ recordingState: 'paused' });\n    this.pause();\n  }\n\n  handleResume() {\n    this.setState({ recordingState: 'recording' });\n    this.resume();\n  }\n\n  handleRecord() {\n    if (!this.hasStreams()) {\n      return;\n    }\n    this.setState({ countdown: true });\n    setTimeout(() => {\n      this.record();\n      this.setState({ recordingState: 'recording' });\n      this.setState({ countdown: false });\n    }, 1000);\n  }\n\n  handleStop() {\n    this.setState({ recordingState: 'inactive' });\n    this.stop();\n  }\n\n  handleDialogClose() {\n    this.setState({ showModal: false });\n    this.resetRecordings();\n  }\n\n  handleSaveCreationSave() {\n    this.handleDialogClose();\n    if (this.state.desktopRecording) {\n      downloadBlob(\n        this.state.desktopRecording.media,\n        getDownloadName('desktop', 'video', this.props.recordingData.title)\n      );\n    }\n    if (this.state.videoRecording) {\n      downloadBlob(\n        this.state.videoRecording.media,\n        getDownloadName('video', 'video', this.props.recordingData.title)\n      );\n    }\n    this.resetRecordings();\n  }\n\n  handleSaveCreationUpload() {\n    const { t } = this.props;\n    const { title, presenter } = this.props.recordingData;\n\n    if (title !== '' && presenter !== '') {\n      this.handleDialogClose();\n      const { hide } = toast.loading(t('upload-notification'), { hideAfter: 0 });\n      new OpencastAPI(this.props.settings).loginAndUpload(\n        // recording,\n        [this.state.desktopRecording, this.state.videoRecording],\n\n        // onsuccess\n        () => {\n          hide();\n          toast.success(t('message-upload-complete'));\n        },\n\n        // onloginfailed\n        () => {\n          hide();\n          toast.error(t('message-login-failed'));\n          // TODO: (mel) We have to find a better way to ensure connection to OC\n          // this.props.handleOpenUploadSettings();\n        },\n\n        // onserverunreachable\n        err => {\n          hide();\n          toast.error(t('message-server-unreachable'));\n          console.error('Server unreachable: ', err);\n          // TODO: (mel) We have to find a better way to ensure connection to OC\n          // this.props.handleOpenUploadSettings();\n        },\n\n        // oninetorpermfailed\n        err => {\n          hide();\n          toast.error(t('message-conn-failed'));\n          console.error('Inet fail or Missing Permission: ', err);\n          // TODO: (mel) We have to find a better way to ensure connection to OC\n          // this.props.handleOpenUploadSettings();\n        },\n\n        title,\n        presenter\n      );\n    } else {\n      toast.info(t('save-creation-form-invalid'));\n    }\n  }\n\n  resetRecordings() {\n    this.desktopRecorder = null;\n    this.videoRecorder = null;\n    this.setState({ desktopRecording: null, videoRecording: null });\n    this.props.setDesktopStream(null);\n    this.props.setVideoStream(null);\n  }\n\n  render() {\n    const { t } = this.props;\n\n    return (\n        <div sx={{ m: 0, mt: 2 }}>\n        {this.hasRecording() && <Beforeunload onBeforeunload={event => event.preventDefault()} />}\n\n        <div sx={{ textAlign: 'center' }}></div>\n\n        <div className=\"buttons\" sx={{ display: 'flex', alignItems: 'center' }}>\n          <div sx={{ flex: 1, textAlign: 'right' }}>\n            {this.state.recordingState === 'recording' && (\n              <PauseButton\n                title={t('pause-button-title')}\n                recordingState={this.state.recordingState}\n                onClick={this.handlePause}\n              />\n            )}\n\n            {this.state.recordingState === 'paused' && (\n              <ResumeButton\n                title={t('resume-button-title')}\n                recordingState={this.state.recordingState}\n                onClick={this.handleResume}\n              />\n            )}\n          </div>\n\n          <div className=\"center\">\n            {this.state.recordingState === 'inactive' ? (\n              <RecordButton\n                large\n                title={t('record-button-title')}\n                recordingState={this.state.recordingState}\n                onClick={this.handleRecord}\n                disabled={!this.hasStreams()}\n                countdown={this.state.countdown}\n              />\n            ) : (\n              <StopButton\n                large\n                title={t('stop-button-title')}\n                recordingState={this.state.recordingState}\n                onClick={this.handleStop}\n              />\n            )}\n          </div>\n\n          <div sx={{ flex: 1 }}>\n            <RecordingState recordingState={this.state.recordingState} />\n          </div>\n        </div>\n\n        <Modal\n          open={this.state.showModal}\n          onClose={this.handleDialogClose}\n          ariaLabelledBy=\"save-creation-modal-label\"\n          closeOnEsc={true}\n          closeOnOverlayClick={true}\n        >\n          <div id=\"save-creation-modal-label\" sx={{ display: 'none' }}>\n            {t('save-creation-modal-title')}\n          </div>\n\n          <SaveCreationDialog\n            desktopRecording={this.state.desktopRecording}\n            videoRecording={this.state.videoRecording}\n            recordingData={this.props.recordingData}\n            setRecordingData={this.props.setRecordingData}\n            handleCancel={this.handleDialogClose}\n            handleSave={this.handleSaveCreationSave}\n            handleUpload={this.handleSaveCreationUpload}\n          />\n        </Modal>\n      </div>\n    );\n  }\n}\n\nexport default withTranslation()(RecordingControls);\n","//; -*- mode: rjsx;-*-\n/** @jsx jsx */\nimport { jsx } from 'theme-ui';\n\nimport { useTranslation } from 'react-i18next';\nimport { Link } from 'react-router-dom';\n\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport {\n  faCog,\n  faExclamationCircle,\n  faPlayCircle,\n  faQuestionCircle\n} from '@fortawesome/free-solid-svg-icons';\n\nconst Icon = props => (\n  <FontAwesomeIcon sx={{ color: 'text', fontSize: 5, verticalAlign: 'middle' }} {...props} />\n);\n\nfunction Toolbar({ settings }) {\n  const { t } = useTranslation();\n\n  return (\n    <div\n      sx={{\n        height: '3rem',\n        lineHeight: '3rem',\n        textAlign: 'right',\n        paddingRight: 2,\n        boxShadow: '0 0px 4px 0px rgba(0, 0, 0, 0.4)',\n        marginBottom: 2,\n        '& > *': {\n          marginLeft: 2\n        }\n      }}\n    >\n      <a href={settings.serverUrl} title={t('toolbar-button-opencast')}>\n        <Icon icon={faPlayCircle} />\n      </a>\n\n      <Link to=\"/settings\" title={t('toolbar-button-upload-settings')}>\n        <Icon icon={faCog} />\n      </Link>\n\n      <a\n        href=\"https://github.com/elan-ev/opencast-studio/issues\"\n        title={t('toolbar-button-issues')}\n        sx={{ paddingLeft: 3 }}\n      >\n        <Icon icon={faExclamationCircle} />\n      </a>\n\n      <Link to=\"/about\" title={t('toolbar-button-about')}>\n        <Icon icon={faQuestionCircle} />\n      </Link>\n    </div>\n  );\n}\n\nexport default Toolbar;\n","//; -*- mode: rjsx;-*-\n/** @jsx jsx */\nimport { jsx } from 'theme-ui';\nimport React from 'react';\nimport { useTranslation } from 'react-i18next';\n\nimport Notification from './notification';\nimport {\n  onSafari,\n  isRecordingSupported,\n} from \"../util\";\n\n// Conditionally shows a number of warnings to help the user identify problems.\nconst Warnings = () => {\n  const { t } = useTranslation();\n\n  // We allow HTTP connections to localhost, as most browsers also seem to allow\n  // video capture in those cases.\n  const usingUnsecureConnection = window.location.protocol !== 'https:' &&\n    window.location.hostname !== \"localhost\" &&\n    window.location.hostname !== \"127.0.0.1\";\n\n  return (\n    <React.Fragment>\n      {!isRecordingSupported() && (\n        <div sx={{ p: 3 }}>\n          <Notification isDanger>\n            {t('warning-recorder-not-supported')}\n            {onSafari() && ' ' + t('warning-recorder-safari-hint')}\n          </Notification>\n        </div>\n      )}\n\n      { usingUnsecureConnection && (\n        <div sx={{ p: 3 }}>\n          <Notification isDanger>\n            {t('warning-https')}\n          </Notification>\n        </div>\n      )}\n    </React.Fragment>\n  );\n};\n\nexport default Warnings;\n","//; -*- mode: rjsx;-*-\n/** @jsx jsx */\nimport { jsx } from 'theme-ui';\n\nimport { useState } from 'react';\nimport { Box, Flex } from '@theme-ui/components';\n\nimport MediaDevices from './media-devices';\nimport RecordingControls from './recording-controls';\nimport Toolbar from './toolbar';\nimport Warnings from './warnings';\n\nconst defaultRecordingData = {\n  title: '',\n  presenter: ''\n};\n\nfunction Studio(props) {\n  const [desktopStream, setDesktopStream] = useState();\n  const [videoStream, setVideoStream] = useState();\n  const [recordingData, setRecordingData] = useState(defaultRecordingData);\n\n  return (\n    <Flex as=\"main\" sx={{ flexDirection: 'column', height: '100%' }}>\n      <Box sx={{ flex: 0 }}>\n        <Toolbar\n          settings={props.settings}\n        />\n      </Box>\n\n      <Warnings />\n\n      <MediaDevices\n        desktopStream={desktopStream}\n        setDesktopStream={setDesktopStream}\n        videoStream={videoStream}\n        setVideoStream={setVideoStream}\n      />\n\n      <RecordingControls\n        desktopStream={desktopStream}\n        setDesktopStream={setDesktopStream}\n        videoStream={videoStream}\n        setVideoStream={setVideoStream}\n        settings={props.settings}\n        recordingData={recordingData}\n        setRecordingData={setRecordingData}\n      />\n    </Flex>\n  );\n}\n\nexport default Studio;\n","//; -*- mode: rjsx;-*-\n/** @jsx jsx */\nimport { jsx } from 'theme-ui';\n\nimport { Box, Flex } from '@theme-ui/components';\nimport PropTypes from 'prop-types';\nimport { BrowserRouter as Router, Switch, Redirect, Route } from 'react-router-dom';\n\nimport useLocalStorage from './use-local-storage';\nimport initial from './default-settings';\n\nimport About from './ui/about';\nimport OpencastHeader from './ui/opencast-header';\nimport Settings from './ui/settings';\nimport Studio from './ui/studio';\n\nconst SETTINGS_KEY = 'ocStudioSettings';\n\nfunction App({ defaultSettings = initial }) {\n  const [settings, updateSettings] = useLocalStorage(SETTINGS_KEY, defaultSettings);\n\n  const handleUpdate = data => {\n    updateSettings(prevState => ({ ...prevState, ...data, connected: true }));\n  };\n\n  return (\n      <Router basename={process.env.PUBLIC_URL || '/'}>\n        <Flex\n          sx={{\n            flexDirection: 'column',\n            minHeight: '100%'\n          }}\n        >\n          <OpencastHeader />\n\n          <Box sx={{ flex: 1, display: 'flex', flexDirection: 'column', '& > *': { flexGrow: 1 } }}>\n            <Switch>\n              <Route path=\"/settings\" exact>\n                <Settings\n                  settings={settings}\n                  handleUpdate={handleUpdate}\n                />\n              </Route>\n\n              <Route path=\"/about\" exact>\n                <About />\n              </Route>\n\n              <ConnectedRoute path=\"/\" exact settings={settings}>\n                <Studio settings={settings} />\n              </ConnectedRoute>\n\n              <Route path=\"/*\">\n                <Redirect to=\"/\" />\n              </Route>\n            </Switch>\n          </Box>\n        </Flex>\n      </Router>\n  );\n}\n\nApp.propTypes = {\n  defaultSettings: PropTypes.object\n}\n\nfunction ConnectedRoute({ children, settings, ...rest }) {\n  return (\n    <Route\n      {...rest}\n      render={({ location }) =>\n        settings.connected ? (\n          children\n        ) : (\n          <Redirect\n            to={{\n              pathname: '/settings',\n              state: { from: location }\n            }}\n          />\n        )\n      }\n    />\n  );\n}\n\nConnectedRoute.propTypes = {\n  children: PropTypes.object,\n  settings: PropTypes.object\n}\n\nexport default App;\n","import React from 'react';\n\nexport default function useLocalStorage(key, initialValue = '') {\n  const [value, setValue] = React.useState(\n    () => JSON.parse(window.localStorage.getItem(key)) || initialValue\n  );\n\n  React.useEffect(() => {\n    window.localStorage.setItem(key, JSON.stringify(value));\n  }, [key, value]);\n\n  return [value, setValue];\n}\n"],"sourceRoot":""}