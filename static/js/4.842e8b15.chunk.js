(this["webpackJsonpopencast-react-studio"]=this["webpackJsonpopencast-react-studio"]||[]).push([[4],{120:function(e,t,n){"use strict";n.r(t);var r=n(20),c=n(5),i=n(88),a=n(1),o=n.n(a),s=n(93),l=n(97),u=n(98),d=n(94),b=n(11),p=function(){return"mediaDevices"in navigator&&"getDisplayMedia"in navigator.mediaDevices&&!(/Android|iPhone|iPad|iPod/i.test(navigator.platform)||/Android/i.test(navigator.userAgent))},f=function(){return"mediaDevices"in navigator&&"getUserMedia"in navigator.mediaDevices},O=function(){return"undefined"!==typeof MediaRecorder},g=function(){return/Safari/i.test(navigator.userAgent)},h=function(e){var t,n,r,c=null!==(t=null===e||void 0===e?void 0:null===(n=e.getVideoTracks())||void 0===n?void 0:null===(r=n[0])||void 0===r?void 0:r.getSettings())&&void 0!==t?t:{};return[c.width,c.height]},j={title:"",presenter:""},v=Object(b.a)({},j),m=function(){return{audioAllowed:null,audioStream:null,audioSupported:f(),displayAllowed:null,displayStream:null,displaySupported:p(),userAllowed:null,userStream:null,userSupported:f(),audioChoice:"none",recordings:[],upload:{error:null,state:"not_uploaded"}}},x=function(e,t){switch(t.type){case"CHOOSE_AUDIO":return Object(b.a)({},e,{audioChoice:t.payload});case"SHARE_AUDIO":return Object(b.a)({},e,{audioStream:t.payload,audioAllowed:!0});case"BLOCK_AUDIO":return Object(b.a)({},e,{audioStream:null,audioAllowed:!1});case"UNSHARE_AUDIO":return Object(b.a)({},e,{audioStream:null});case"SHARE_DISPLAY":return Object(b.a)({},e,{displayStream:t.payload,displayAllowed:!0});case"BLOCK_DISPLAY":return Object(b.a)({},e,{displayStream:null,displayAllowed:!1});case"UNSHARE_DISPLAY":return Object(b.a)({},e,{displayStream:null});case"SHARE_USER":return Object(b.a)({},e,{userStream:t.payload,userAllowed:!0});case"BLOCK_USER":return Object(b.a)({},e,{userStream:null,userAllowed:!1});case"UNSHARE_USER":return Object(b.a)({},e,{userStream:null});case"ADD_RECORDING":return Object(b.a)({},e,{recordings:[].concat(Object(d.a)(e.recordings),[t.payload])});case"UPLOAD_ERROR":case"UPLOAD_FAILURE":return Object(b.a)({},e,{upload:Object(b.a)({},e.upload,{error:t.payload,state:"error"})});case"UPLOAD_REQUEST":return Object(b.a)({},e,{upload:Object(b.a)({},e.upload,{error:null,state:"uploading"})});case"UPLOAD_SUCCESS":return Object(b.a)({},e,{upload:Object(b.a)({},e.upload,{error:null,state:"uploaded"})});case"MARK_DOWNLOADED":var n=e.recordings.map((function(e,n){return n===t.payload?Object(b.a)({},e,{downloaded:!0}):e}));return Object(b.a)({},e,{recordings:n});case"RESET":return v=Object(b.a)({},j),m();default:throw new Error}},y=Object(a.createContext)(null),w=Object(a.createContext)(null),S=function(e){var t=e.children,n=Object(a.useReducer)(x,m()),i=Object(r.a)(n,2),o=i[0],s=i[1];return Object(c.c)(w.Provider,{value:s},Object(c.c)(y.Provider,{value:o},t))},k=function(){return Object(a.useContext)(w)},C=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=Object(a.useContext)(y);return null!==e?t[e]:t},A=n(42),D=n(89),E=n(90);function R(){return Object(c.c)("article",null,Object(c.c)(A.b.h2,null,"ELAN e.V."),Object(c.c)(A.b.p,null,"The e-learning academic network (ELAN e.V.) is a German non-profit organization supporting higher-education organizations in all matters related to e-learning. Our services include practical tips about how to use digital technologies in education, legal advice and development of free, open-source software to support education."),Object(c.c)(A.b.h3,null,"Contact"),Object(c.c)(A.b.p,null,"Dr. Norbert Kleinefeld, Gesch\xe4ftsf\xfchrer",Object(c.c)("br",null),"Karlstr. 23",Object(c.c)("br",null),"D-26123 Oldenburg"),Object(c.c)(A.b.p,null,Object(c.c)(D.a,{icon:E.m})," ",Object(c.c)(A.b.a,{href:"https://elan-ev.de"},"elan-ev.de"),Object(c.c)("br",null),Object(c.c)(D.a,{icon:E.j})," ",Object(c.c)(A.b.a,{href:"mailto:kontakt@elan-ev.de"},"kontakt@elan-ev.de"),Object(c.c)("br",null),Object(c.c)(D.a,{icon:E.s})," ",Object(c.c)(A.b.a,{href:"tel:+4944199866610"},"+49\u2009441 998\u2009666\u200910")),Object(c.c)(A.b.p,null,"Registergericht: Amtsgericht Oldenburg",Object(c.c)("br",null),"Registernummer: VR 200644",Object(c.c)("br",null),"USt.-ID-Nr.: DE 265901392"))}var H=function(e){return Object(c.c)(i.d,null,Object(c.c)("article",null,Object(c.c)("header",null,Object(c.c)(A.b.h1,null,"Opencast Studio")),Object(c.c)(A.b.p,null,"A web-based recording studio for ",Object(c.c)(A.b.a,{href:"https://opencast.org"},"Opencast"),".",Object(c.c)(A.b.p,null),"Opencast Studio allows you to record your camera, your display and your microphone\u02bcs audio. You can then either download your recordings or upload them directly to an Opencast instance (usually the one of your university)."),Object(c.c)(A.b.p,null,"This application is free, open software developed"," ",Object(c.c)(A.b.a,{href:"https://github.com/elan-ev/opencast-studio"},"on GitHub"),"."),Object(c.c)(A.b.h2,null,"How it works"),Object(c.c)(A.b.p,null,"Opencast Studio uses the recording capabilities built into modern browsers to record audio and video streams. The recording happens in the user\u02bcs browser and no server is involved in the recording."),Object(c.c)(o.a.Fragment,null,Object(c.c)(A.b.h2,null,"Support"),Object(c.c)(A.b.p,null,"If you are interested in additional development or want to introduce Opencast Studio at your university, please contact"," ",Object(c.c)(A.b.a,{href:"mailto:opencast-support@elan-ev.de"},"opencast-support@elan-ev.de"),".")),Object(c.c)(R,null),Object(c.c)(A.b.h2,null,"Version"),Object(c.c)(A.b.p,null,"Build date ","2020-03-13",", commit"," ",Object(c.c)(A.b.a,{"aria-label":"Git commit on GitHub",href:"https://github.com/elan-ev/opencast-studio/commit/ce24c16"},"ce24c16"),".")))},U=n(91),T=n(43),I=function(e){var t=e.target,n=e.children,r=e.icon,i=Object(U.a)(e,["target","children","icon"]),a=Object(l.g)();return Object(c.c)(s.c,Object.assign({to:{pathname:t,search:a.search},exact:!0,activeStyle:{backgroundColor:"black"},sx:{color:"white",pl:[3,3,"10px"],pr:[3,3,"14px"],textDecoration:"none",fontSize:"18px",height:["auto","auto","100%"],borderLeft:["none","none",function(e){return"1px solid ".concat(e.colors.gray[3])}],display:["block","block","inline-block"],width:["100%","100%","auto"],"&:hover":{backgroundColor:"gray.1"}}},i),Object(c.c)("div",{sx:{width:"20px",display:"inline-block",textAlign:"right",mr:[3,3,2]}},Object(c.c)(D.a,{icon:r})),n)},L=function(e){var t=Object(a.useState)(!1),n=Object(r.a)(t,2),i=n[0],o=n[1],s=function(){return o(!1)},l=Object(T.c)().t;return Object(c.c)(a.Fragment,null,Object(c.c)("button",{onClick:function(){return o(!i)},sx:{display:["inline-block","inline-block","none"],border:function(e){return"2px solid ".concat(e.colors.gray[3])},borderRadius:"10px",color:"white",my:1,px:3,mx:1,fontSize:"20px",whiteSpace:"nowrap",backgroundColor:"transparent","&:hover":{backgroundColor:"gray.1"},"&:active":{}}},l("nav-open-menu-button"),Object(c.c)("span",{sx:{width:"23px",display:"inline-block"}},Object(c.c)(D.a,{icon:i?E.w:E.a,sx:{ml:"10px"}}))),Object(c.c)("nav",{ref:function(e){e&&(e.style.height=i?e.scrollHeight+"px":"")},sx:{overflow:"hidden",zIndex:10,height:["0px","0px","100% !important"],top:[function(e){return e.heights.headerHeight},function(e){return e.heights.headerHeight},0],position:["absolute","absolute","static"],width:["100%","100%","auto"],backgroundColor:["gray.0","gray.0","none"],transition:["height 0.25s ease-out 0s","height 0.25s ease-out 0s","none"],scrollX:["none","none","auto"]}},Object(c.c)(I,{target:"/",icon:E.z,onClick:s},l("nav-recording")),Object(c.c)(I,{target:"/settings",icon:E.A,onClick:s},l("nav-settings")),Object(c.c)(I,{target:"/about",icon:E.n,onClick:s},l("nav-about"))),i&&Object(c.c)("div",{onClick:s,ref:function(e){return e&&(e.style.opacity=1)},sx:{display:[i?"block":"none",i?"block":"none","none"],backgroundColor:"rgba(0, 0, 0, 0.7)",position:"fixed",zIndex:-10,top:0,bottom:0,left:0,right:0,opacity:0,transition:"opacity 0.25s ease-out 0s"}}))},_=function(e){return Object(c.c)("span",Object.assign({sx:{position:"relative",top:"4px",fontSize:"12pt",verticalAlign:"top",display:["none","inline"],borderWidth:1,borderStyle:"solid",borderColor:"gray.2",borderRadius:5,padding:"2px",color:"gray.2"}},e))};function z(){var e=Object(l.g)();return Object(c.c)("span",null,Object(c.c)(s.b,{to:{pathname:"/",search:e.search}},Object(c.c)("picture",null,Object(c.c)("source",{media:"(min-width: 920px)",srcSet:"".concat("","/opencast-studio.svg")}),Object(c.c)("img",{src:"".concat("","/opencast-studio-small.svg"),alt:"Opencast Studio",sx:{height:50}}))),Object(c.c)(_,null,"beta"))}var P=function(){return Object(c.c)("header",{sx:{height:function(e){return e.heights.headerHeight},lineHeight:function(e){return e.heights.headerHeight},color:"background",display:"flex",justifyContent:"space-between",position:"relative",zIndex:3}},Object(c.c)("div",{sx:{backgroundColor:"gray.0",position:"absolute",zIndex:-3,height:"100%",width:"100%"}}),Object(c.c)(z,null),Object(c.c)(L,null))};function W(e){var t,n=e.activeStep,r=e.updateActiveStep,i=Object(U.a)(e,["activeStep","updateActiveStep"]),a={currentStep:n+1,totalSteps:(null===(t=i.children)||void 0===t?void 0:t.length)||0,nextStep:function(){u(n+1)},previousStep:function(){u(n-1)},goToStep:l,firstStep:function(){l(1)},lastStep:function(){l(i.children.length)}},s=o.a.Children.map(i.children,(function(e,t){return a.isActive=t===n,a.isActive?function(e){var t=e.type;return"function"===typeof t||"object"===typeof t}(e)?o.a.cloneElement(e,a):e:null}));return Object(c.c)(o.a.Fragment,null,s);function l(e){u(e-1)}function u(e){n!==e&&(!function(e,t){return e<0||e>=t.length}(e,i.children)?r(e):console.error("".concat(e+1," is an invalid step")))}}var M=n(3),N=n.n(M),B=n(9);function F(){return(F=Object(B.a)(N.a.mark((function e(t){var n,r,c=arguments;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=c.length>1&&void 0!==c[1]?c[1]:null,e.prev=1,e.next=4,navigator.mediaDevices.getUserMedia({audio:!n||{deviceId:n},video:!1});case 4:return(r=e.sent).getTracks().forEach((function(e){e.onended=function(){t({type:"UNSHARE_AUDIO"})}})),t({type:"SHARE_AUDIO",payload:r}),e.abrupt("return",!0);case 10:return e.prev=10,e.t0=e.catch(1),console.error("Error: "+e.t0),t({type:"BLOCK_AUDIO"}),e.abrupt("return",!1);case 15:case"end":return e.stop()}}),e,null,[[1,10]])})))).apply(this,arguments)}function q(e){return K.apply(this,arguments)}function K(){return(K=Object(B.a)(N.a.mark((function e(t){var n,r,c=arguments;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=c.length>1&&void 0!==c[1]?c[1]:{video:!0,audio:!1},e.prev=1,e.next=4,navigator.mediaDevices.getDisplayMedia(n);case 4:(r=e.sent).getTracks().forEach((function(e){e.onended=function(){t({type:"UNSHARE_DISPLAY"})}})),t({type:"SHARE_DISPLAY",payload:r}),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(1),console.error("Error: "+e.t0),t({type:"BLOCK_DISPLAY"});case 13:case"end":return e.stop()}}),e,null,[[1,9]])})))).apply(this,arguments)}var V={audio:!0,video:{width:{ideal:1280,max:1920},height:{ideal:720,max:1080}}};function G(e){return Y.apply(this,arguments)}function Y(){return(Y=Object(B.a)(N.a.mark((function e(t){var n,r,c,i=arguments;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=i.length>1&&void 0!==i[1]?i[1]:null,r=n||V,e.prev=2,e.next=5,navigator.mediaDevices.getUserMedia(r);case 5:(c=e.sent).getTracks().forEach((function(e){e.onended=function(){t({type:"UNSHARE_USER"})}})),t({type:"SHARE_USER",payload:c}),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(2),console.error("Error: "+e.t0),t({type:"BLOCK_USER"});case 14:case"end":return e.stop()}}),e,null,[[2,10]])})))).apply(this,arguments)}function J(e,t){e&&e.getTracks().forEach((function(e){return e.stop()})),t({type:"UNSHARE_AUDIO"})}function Q(e,t){e&&e.getTracks().forEach((function(e){return e.stop()})),t({type:"UNSHARE_DISPLAY"})}function X(e,t){e&&e.getTracks().forEach((function(e){return e.stop()})),t({type:"UNSHARE_USER"})}var Z=n(113),$=n.n(Z),ee=n(36),te=n.n(ee);function ne(e){var t=e.prev,n=void 0===t?null:t,r=e.next,a=void 0===r?null:r,o=e.children,s=Object(T.c)().t;return Object(c.c)(i.e,{sx:{alignItems:"end",minHeight:"40px"}},Object(c.c)(i.a,{sx:{flex:"1 1 0",textAlign:"left"}},n&&Object(c.c)(i.b,{sx:Object(b.a)({whiteSpace:"nowrap"},!0===n.danger?{variant:"buttons.danger"}:{variant:"buttons.text"}),onClick:n.onClick,disabled:n.disabled,danger:n.danger||!1},Object(c.c)(D.a,{icon:E.b}),s(n.label||"back-button-label"))),Object(c.c)(i.a,null,o),Object(c.c)(i.a,{sx:{flex:"1 1 0",textAlign:"right"}},a&&Object(c.c)(i.b,{sx:Object(b.a)({whiteSpace:"nowrap","& svg":{mr:0,ml:2}},!0===a.danger?{variant:"buttons.danger"}:{}),onClick:a.onClick,disabled:a.disabled},s(a.label||"next-button-label"),Object(c.c)(D.a,{icon:E.c}))))}var re=o.a.createContext(null),ce=function(){return o.a.useContext(re)};function ie(e){var t=e.gap,n=void 0===t?0:t,i=e.children,o=$()(),s=o.ref,l=o.width,u=void 0===l?1:l,d=o.height,b=void 0===d?1:d,p=Object(a.useState)(0),f=Object(r.a)(p,2)[1],O=i.map((function(e){return e.dimensions()})),g=function(){var e=i.map((function(e){return e.dimensions()}));te()(e,O)||(O=e,f((function(e){return e+1})))},h=function(e){var t=Object(r.a)(e,2),n=t[0],c=t[1];return n&&c?n/c:16/9};switch(i.length){case 1:var j,v,m=i[0],x=m.extraHeight||0,y=h(m.dimensions()),w=b-x;return u>w*y?(v=w+x,j=w*y):(j=u,v=u/y+x),Object(c.c)(re.Provider,{value:g},Object(c.c)("div",{ref:s,sx:{flex:"1 0 0",minHeight:0,display:"flex"}},Object(c.c)("div",{sx:{height:v,width:j,minWidth:"180px",margin:"auto"}},m.body)));case 2:var S,k,C,A=i.map((function(e){return h(e.dimensions())})),D=function(){var e=Math.max(i[0].extraHeight||0,i[1].extraHeight||0),t=b-e,r=u-n,c=A[0]+A[1];if(r>t*c)return{rowHeights:Array(2).fill(t+e),rowWidths:A.map((function(e){return t*e}))};var a=r/c;return{rowHeights:i.map((function(e){return a+(e.extraHeight||0)})),rowWidths:A.map((function(e){return a*e}))}}(),E=D.rowWidths,R=D.rowHeights,H=function(){var e=n+(i[0].extraHeight||0)+(i[1].extraHeight||0),t=b-e,r=1/(1/A[0]+1/A[1]);if(u>t*r){var c=t*r;return{colHeights:i.map((function(e,t){return c/A[t]+(e.extraHeight||0)})),colWidths:Array(2).fill(c)}}return{colHeights:i.map((function(e,t){return u/A[t]+(e.extraHeight||0)})),colWidths:Array(2).fill(u)}}(),U=H.colWidths,T=H.colHeights;return E[0]*R[0]+E[1]*R[1]>U[0]*T[0]+U[1]*T[1]?(C="row",S=E,k=R):(C="column",S=U,k=T),Object(c.c)(re.Provider,{value:g},Object(c.c)("div",{ref:s,sx:{flex:"1 0 0",display:"flex",flexDirection:C,justifyContent:"space-between",minHeight:0}},Object(c.c)("div",{sx:{height:k[0],width:S[0],minWidth:"180px",margin:"auto"}},i[0].body),Object(c.c)("div",{sx:{height:k[1],width:S[1],minWidth:"180px",margin:"auto"}},i[1].body)));default:return Object(c.c)("p",null,"Internal error: too few or too many video streams")}}var ae=function(e){var t=e.isDanger,n=Object(U.a)(e,["isDanger"]);return Object(c.c)("div",Object.assign({sx:{":not(:last-child)":{marginBottom:"1.5rem"},backgroundColor:t?"error":"gray.3",color:t?"background":"currentColor",borderRadius:2,padding:3,position:"relative"}},n))},oe=n(115);function se(e){var t=e.stream,n=(Object(U.a)(e,["stream"]),Object(a.useRef)()),r=Object(c.e)().theme;return Object(a.useEffect)((function(){var e=n.current;if(e){var r=e.getContext("2d");r.lineWidth=2,r.strokeStyle="#f1c40f";var c=(new(window.AudioContext||window.webkitAudioContext)).createMediaStreamSource(t),i=new oe.a(c,{fftSize:1024});return i.animate(r),function(){return i.stop()}}return function(){}}),[r.colors,t]),Object(c.c)("canvas",{ref:n,sx:{width:"80%",height:"100px",bg:"rgba(0,0,0,0.8)",m:3,mb:0,borderRadius:"7px"}})}function le(e){var t=Object(T.c)().t,n=k(),r=C(),a=r.audioStream,o=r.audioAllowed,s="none"===r.audioChoice||"microphone_request"===r.audioChoice||"microphone"===r.audioChoice&&!a;return Object(c.c)(i.d,{sx:{display:"flex",flexDirection:"column",flex:"1 1 auto",justifyContent:"space-between"}},Object(c.c)(A.b.h1,{sx:{textAlign:"center"}},t("sources-audio-question")),Object(c.c)(i.e,{sx:{flexDirection:["column","row"],maxWidth:850,width:"100%",mx:"auto",mb:3,flex:"1 0 auto",maxHeight:["none","350px"],"& > :first-of-type":{mb:[3,0],mr:[0,3]}}},Object(c.c)(ue,{icon:E.o,label:t("sources-audio-microphone"),selected:"microphone"===r.audioChoice,onClick:function(){n({type:"CHOOSE_AUDIO",payload:"microphone_request"}),function(e){return F.apply(this,arguments)}(n).then((function(e){n({type:"CHOOSE_AUDIO",payload:e?"microphone":"none"})}))}},"microphone_request"===r.audioChoice&&Object(c.c)(i.g,{size:"75"}),a&&Object(c.c)(se,{stream:a}),!1===o&&"microphone_request"!==r.audioChoice&&Object(c.c)(ae,{isDanger:!0,sx:{mt:2}},Object(c.c)(i.f,{as:"h3",mb:2},t("source-audio-not-allowed-title")),Object(c.c)(i.h,{variant:"text"},t("source-audio-not-allowed-text")))),Object(c.c)(ue,{icon:E.p,label:t("sources-audio-without-audio"),selected:"no-audio"===r.audioChoice,onClick:function(){n({type:"CHOOSE_AUDIO",payload:"no-audio"}),a&&J(a,n)}})),Object(c.c)(ne,{prev:{onClick:function(){return e.previousStep()}},next:{onClick:function(){return e.nextStep()},disabled:s}}))}var ue=function(e){var t=e.children,n=e.icon,r=e.label,i=e.selected,a=e.onClick,o=i?{backgroundColor:"highlight"}:{};return Object(c.c)("button",{onClick:function(){return i||a()},sx:Object(b.a)({fontFamily:"inherit",color:"gray.0",border:"2px solid black",borderRadius:"8px",flex:"0 1 50%",p:2},o)},Object(c.c)("div",{sx:{display:"block",textAlign:"center",mb:3}},Object(c.c)(D.a,{icon:n,size:"3x"})),Object(c.c)("div",{sx:{fontSize:4}},r),t)},de=n(39);var be=function(e){return Object(c.c)("div",{sx:{"&:not(:last-child)":{marginBottom:3}}},Object(c.c)("label",{sx:{color:"gray.0",display:"block",fontSize:2,fontWeight:"bold"}},e.label,Object(c.c)("div",{sx:{boxSizing:"border-box",clear:"both",fontSize:2,position:"relative",textAlign:"left"}},e.children)))},pe=function(e){var t,n=e.deviceType,r=e.url,a=e.mimeType,o=e.onDownload,s=e.downloaded,l=Object(T.c)().t,u="desktop"===n?"presentation":"presenter";t=a&&a.startsWith("video/webm")?"webm":a&&a.startsWith("video/mp4")?"mp4":g()?"mp4":"webm";var d="oc-studio-".concat(fe(),"-").concat(u,".").concat(t);return r?Object(c.c)("div",{sx:{display:"flex",flexDirection:"column",flex:"0 0 auto",mx:2,pb:"12px",alignItems:"center"}},Object(c.c)("div",{sx:{position:"relative",height:"150px",border:function(e){return"2px solid ".concat(e.colors.gray[1])}}},Object(c.c)("video",{muted:!0,src:r,onLoadedData:function(e){return e.target.currentTime=0},preload:"auto",sx:{maxWidth:"100%",height:"100%"}}),s&&Object(c.c)("div",{sx:{position:"absolute",top:0,left:0,right:0,bottom:0,display:"flex",justifyContent:"center",alignItems:"center",color:"primary",backgroundColor:"rgba(0, 0, 0, 0.4)"}},Object(c.c)(D.a,{icon:E.f,size:"4x"}))),Object(c.c)(i.b,{as:"a",sx:{width:"100%",maxWidth:"170px",margin:"auto",mt:"10px"},target:"_blank",download:d,href:r,rel:"noopener noreferrer",onClick:o},Object(c.c)(D.a,{icon:E.i}),l("save-creation-download-button"))):null},fe=function(){var e=function(e){return e>=10?""+e:"0"+e},t=new Date;return t.getFullYear()+"-"+e(t.getMonth()+1)+"-"+e(t.getDate())+"_"+e(t.getHours())+"-"+e(t.getMinutes())},Oe=function(e){return Object(c.c)("input",Object.assign({sx:{variant:"styles.input"}},e))};function ge(e){var t=Object(l.g)(),n=e.settings,r=Object(T.c)().t,a=Object(de.j)(),u=C(),d=u.recordings,b=u.upload,p=k();function f(e){var t=e.target;v[t.name]=t.value}function O(){return(O=Object(B.a)(N.a.mark((function e(){var t,c,i,o,s,l;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=v.title,o=v.presenter,""!==i&&""!==o){e.next=4;break}return p({type:"UPLOAD_ERROR",payload:r("save-creation-form-invalid")}),e.abrupt("return");case 4:return p({type:"UPLOAD_REQUEST"}),s=null===(t=n.upload)||void 0===t?void 0:t.workflowId,l=null===(c=n.upload)||void 0===c?void 0:c.seriesId,e.next=9,a.upload({recordings:d.filter(Boolean),title:i,creator:o,workflowId:s,seriesId:l});case 9:if(!e.sent){e.next=14;break}p({type:"UPLOAD_SUCCESS"}),e.next=21;break;case 14:e.t0=a.getState(),e.next=e.t0===de.d?17:19;break;case 17:return p({type:"UPLOAD_FAILURE",payload:r("message-login-failed")}),e.abrupt("break",21);case 19:return p({type:"UPLOAD_FAILURE",payload:r("message-server-unreachable")}),e.abrupt("break",21);case 21:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var g,h=d.every((function(e){return e.downloaded})),j="uploaded"===b.state||h;return g=a.isReadyToUpload()?"uploaded"===b.state?Object(c.c)(o.a.Fragment,null,Object(c.c)("div",{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"130px",color:"primary"}},Object(c.c)(D.a,{icon:E.f,size:"4x"})),Object(c.c)(i.h,{sx:{textAlign:"center"}},r("message-upload-complete"))):Object(c.c)(o.a.Fragment,null,Object(c.c)(be,{label:r("save-creation-label-title")},Object(c.c)(Oe,{name:"title",autoComplete:"off",defaultValue:v.title,onChange:f,disabled:"uploading"===b.state})),Object(c.c)(be,{label:r("save-creation-label-presenter")},Object(c.c)(Oe,{name:"presenter",autoComplete:"off",defaultValue:v.presenter,onChange:f,disabled:"uploading"===b.state})),Object(c.c)(i.b,{onClick:function(){return O.apply(this,arguments)},disabled:0===d.length||"uploading"===b.state},Object(c.c)(D.a,{icon:E.x}),a.prettyServerUrl()?Object(c.c)(T.a,{i18nKey:"save-creation-upload-to"},"Upload to ",Object(c.c)("code",{sx:{backgroundColor:"rgba(0, 0, 0, 0.1)",borderRadius:"5px",padding:"1px 3px"}},{server:a.prettyServerUrl()})):r("save-creation-button-upload")),"uploading"===b.state&&Object(c.c)(i.g,{size:"40",sx:{verticalAlign:"middle",ml:3}}),Object(c.c)(i.a,{sx:{mt:2}},function(){switch(b.state){case"error":return Object(c.c)(ae,{isDanger:!0},b.error);case"uploading":return Object(c.c)(ae,null,r("upload-notification"));default:return null}}())):Object(c.c)(ae,{key:"opencast-connection",isDanger:!0},Object(c.c)(T.a,{i18nKey:"warning-missing-connection-settings"},"Warning.",Object(c.c)(s.b,{to:{pathname:"/settings",search:t.search},sx:{variant:"styles.a",color:"#ff2"}},"settings"))),Object(c.c)(i.d,{sx:{display:"flex",flexDirection:"column",flex:"1 0 auto"}},Object(c.c)(A.b.h1,{sx:{textAlign:"center",fontSize:["26px","30px","32px"]}},r(j?"save-creation-title-done":"save-creation-title")),Object(c.c)("div",{sx:{display:"flex",flexDirection:["column","column","row"],"& > *":{flex:"1 0 50%",p:[2,2,"0 32px"],"&:last-child":{borderLeft:["none","none",function(e){return"1px solid ".concat(e.colors.gray[3])}]}}}},Object(c.c)("div",null,Object(c.c)(A.b.h2,{sx:{pb:1,borderBottom:function(e){return"1px solid ".concat(e.colors.gray[2])}}},r("save-creation-subsection-title-upload")),Object(c.c)("div",{sx:{margin:"auto"}},g)),Object(c.c)("div",null,Object(c.c)(A.b.h2,{sx:{pb:1,borderBottom:function(e){return"1px solid ".concat(e.colors.gray[2])}}},r("save-creation-subsection-title-download")),Object(c.c)("div",{sx:{display:"flex",flexDirection:"row",justifyContent:["center","center","start"],flexWrap:"wrap"}},0===d.length?Object(c.c)(i.g,null):d.map((function(e,t){return Object(c.c)(pe,{key:t,deviceType:e.deviceType,mimeType:e.mimeType,url:e.url,downloaded:e.downloaded,onDownload:function(){return p({type:"MARK_DOWNLOADED",payload:t})}})}))))),Object(c.c)("div",{sx:{flex:"1 0 40px"}}),Object(c.c)(ne,{next:null,prev:j?null:{onClick:function(){e.previousStep()},disabled:!1}},j?Object(c.c)(i.b,{sx:{whiteSpace:"nowrap"},onClick:function(){window.confirm(r("save-creation-new-recording-warning"))&&(p({type:"RESET"}),e.firstStep())}},Object(c.c)(D.a,{icon:E.u}),r("save-creation-new-recording")):null))}function he(e){e.reselectSource;var t,n=e.warnings,r=e.inputs;switch(r.length){case 1:t=[{body:Object(c.c)(je,{input:r[0],text:r[0].kind}),dimensions:function(){return h(r[0].stream)},extraHeight:40}];break;case 2:t=[{body:Object(c.c)(je,{input:r[0],text:r[0].kind}),dimensions:function(){return h(r[0].stream)},extraHeight:40},{body:Object(c.c)(je,{input:r[1],text:r[1].kind}),dimensions:function(){return h(r[1].stream)},extraHeight:40}];break;default:return Object(c.c)("p",null,"Something went very wrong")}return Object(c.c)(a.Fragment,null,n,Object(c.c)(ie,{gap:20},t))}function je(e){var t,n,r=e.input,a=e.text,o=r.stream,s=null===o||void 0===o?void 0:null===(t=o.getVideoTracks())||void 0===t?void 0:t[0],l=null!==(n=null===s||void 0===s?void 0:s.getSettings())&&void 0!==n?n:{},u=l.width,d=l.height;return Object(c.c)(i.c,{sx:{display:"flex",flexDirection:"column",height:"100%",minHeight:0}},Object(c.c)(ve,{allowed:r.allowed,stream:o}),Object(c.c)(i.h,{p:2,color:"muted",sx:{height:"".concat(40,"px")}},a,s&&": ".concat(u,"\xd7").concat(d)))}var ve=function(e){var t,n=e.allowed,r=e.stream,o=(Object(U.a)(e,["allowed","stream"]),ce()),s=Object(a.useRef)();return Object(a.useEffect)((function(){var e=s.current;return e&&(e.srcObject||(e.srcObject=r),e.addEventListener("resize",o)),function(){e&&e.removeEventListener("resize",o)}}),[r,o]),r?Object(c.c)("video",{ref:s,autoPlay:!0,muted:!0,sx:{minHeight:0,display:"block",width:"100%",height:"100%"}}):(t=!1===n?Object(c.c)(D.a,{icon:E.l,size:"3x"}):Object(c.c)(i.g,{size:"75"}),Object(c.c)("div",{sx:{width:"100%",height:"100%",minHeight:"120px",display:"flex",justifyContent:"center",alignItems:"center"}},t))};function me(e){var t,n,s,l=Object(T.c)().t,u=k(),d=C(),b=d.displayStream,p=d.userStream,f=d.displaySupported,O=d.userSupported,g=b||p,h=f||O,j=f&&O,v=Object(a.useState)((b&&p?"both":b&&"display")||p&&"user"||"none"),m=Object(r.a)(v,2),x=m[0],y=m[1],w={video:{height:{ideal:1080},facingMode:"user"},audio:!1},S=function(){var e=Object(B.a)(N.a.mark((function e(){return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return y("user"),e.next=3,G(u,w);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),D=function(){var e=Object(B.a)(N.a.mark((function e(){return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return y("display"),e.next=3,q(u);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),R=function(){var e=Object(B.a)(N.a.mark((function e(){return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return y("both"),e.next=3,G(u,w);case 3:return e.next=5,q(u);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),H=function(){y("none"),X(d.userStream,u),Q(d.displayStream,u)},U="none"===x||"both"===x?!b||!p:!g,I=!1===d.userAllowed&&Object(c.c)(ae,{isDanger:!0},Object(c.c)(i.f,{as:"h3",mb:2},l("source-user-not-allowed-title")),Object(c.c)(i.h,null,l("source-user-not-allowed-text"))),L=!1===d.displayAllowed&&Object(c.c)(ae,{isDanger:!0},Object(c.c)(i.f,{as:"h3",mb:2},l("source-display-not-allowed-title")),Object(c.c)(i.h,null,l("source-display-not-allowed-text")));switch(x){case"none":n=l("sources-video-question"),t=!0,s=h?Object(c.c)(o.a.Fragment,null,Object(c.c)(ye,null),Object(c.c)(i.e,{sx:{flexDirection:["column","row"],maxWidth:[270,850],width:"100%",mx:["auto","none"],mb:3,flex:"4 1 auto",maxHeight:["none","270px"],justifyContent:"center","& > :not(:last-of-type)":{mb:[3,0],mr:[0,3]}}},f&&Object(c.c)(xe,{label:l("sources-scenario-display"),icon:E.d,onClick:D}),j&&Object(c.c)(xe,{label:l("sources-scenario-display-and-user"),icon:E.e,onClick:R}),O&&Object(c.c)(xe,{label:l("sources-scenario-user"),icon:E.y,onClick:S})),Object(c.c)(ye,null)):Object(c.c)(ae,{isDanger:!0},l("sources-video-none-available"));break;case"user":n=l("sources-video-user-selected"),t=!d.userStream&&!1!==d.userAllowed,s=Object(c.c)(he,{reselectSource:H,warnings:I,inputs:[{kind:l("sources-user"),stream:d.userStream,allowed:d.userAllowed}]});break;case"display":n=l("sources-video-display-selected"),t=!d.displayStream&&!1!==d.displayAllowed,s=Object(c.c)(he,{reselectSource:H,warnings:L,inputs:[{kind:l("sources-display"),stream:d.displayStream,allowed:d.displayAllowed}]});break;case"both":n=l("sources-video-display-and-user-selected"),t=!d.userStream&&!1!==d.userAllowed||!d.displayStream&&!1!==d.displayAllowed,s=Object(c.c)(he,{reselectSource:H,warnings:[L,I],inputs:[{kind:l("sources-display"),stream:d.displayStream,allowed:d.displayAllowed},{kind:l("sources-user"),stream:d.userStream,allowed:d.userAllowed}]});break;default:return Object(c.c)("p",null,"Something went very wrong")}return Object(c.c)(i.d,{sx:{display:"flex",flexDirection:"column",flex:"1 1 auto",minHeight:0}},Object(c.c)(A.b.h1,{sx:{textAlign:"center",fontSize:["26px","30px","32px"]}},n),s,"none"!==x&&Object(c.c)("div",{sx:{mb:3}}),"none"!==x&&Object(c.c)(ne,{next:t?null:{onClick:function(){return e.nextStep()},disabled:U},prev:t?null:{onClick:H,disabled:!1,label:"sources-video-reselect-source"}}))}var xe=function(e){var t=e.icon,n=e.label,r=e.onClick;return Object(c.c)("button",{onClick:r,sx:{fontFamily:"inherit",color:"gray.0",border:"2px solid black",borderRadius:"8px",flex:["1 1 auto","0 1 100%"],minWidth:"180px",maxWidth:"300px",minHeight:"120px",maxHeight:"250px",p:2}},Object(c.c)("div",{sx:{display:"block",textAlign:"center",mb:3}},Object(c.c)(D.a,{icon:t,size:"3x"})),Object(c.c)("div",{sx:{fontSize:4}},n))},ye=function(e){return Object(c.c)("div",Object.assign({sx:{flex:"1 0 0"}},e))};function we(e){var t=e.recordingState,n=Object(T.c)().t,r=C(),i=r.displayStream,a=r.userStream,o=t===Ye,s=[];return i&&s.push({body:Object(c.c)(Se,{title:n("share-desktop"),stream:i,paused:o}),dimensions:function(){return h(i)}}),a&&s.push({body:Object(c.c)(Se,{title:n("share-camera"),stream:a,paused:o}),dimensions:function(){return h(a)}}),Object(c.c)(ie,{gap:20},s)}function Se(e){e.title;var t=e.stream,n=e.paused,r=ce(),i=Object(a.useRef)();return Object(a.useEffect)((function(){var e=i.current;return e&&"undefined"!=typeof t&&(e.srcObject||(e.srcObject=t),e.addEventListener("resize",r),n?e.pause():e.play()),function(){return e.removeEventListener("resize",r)}})),Object(c.c)("div",{sx:{position:"relative",backgroundColor:"gray.3",boxShadow:"0 2px 2px rgba(0, 0, 0, 0.35)",overflow:"hidden",height:"100%",cursor:t?"initial":"pointer"}},n&&Object(c.c)("div",{sx:{position:"absolute",width:"100%",height:"100%",backgroundColor:"rgba(255, 255, 255, 0.5)"}},Object(c.c)(D.a,{icon:E.q,sx:{fontSize:"140px",maxWidth:"40%",maxHeight:"40%",position:"absolute",top:0,left:0,bottom:0,right:0,margin:"auto",animation:"3s ease-in-out infinite none pulse"}})),Object(c.c)("video",{ref:i,autoPlay:!0,muted:!0,sx:{outline:"none",width:"100%",height:"100%",background:"transparent"}}))}var ke=n(34),Ce=n(35),Ae=function(){function e(t){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object(ke.a)(this,e);var c=r.mimeType||void 0,i=h(t),a=[];this.recorder=new MediaRecorder(t,{mimeType:c}),this.recorder.ondataavailable=function(e){e.data.size>0&&a.push(e.data)},this.recorder.onerror=function(e){r.onError&&r.onError(e)},this.recorder.onstop=function(){var e=a[0].type||n.recorder.mimeType,t=new Blob(a,{type:e}),c=URL.createObjectURL(t);n.recorder=null,r.onStop&&r.onStop({url:c,media:t,mimeType:e,dimensions:i})},this.isRecording=!1,this.isPaused=!1}return Object(Ce.a)(e,[{key:"start",value:function(){this.isRecording||(this.recorder.start(),this.isRecording=!0)}},{key:"pause",value:function(){this.isPaused||(this.recorder.pause(),this.isPaused=!0)}},{key:"resume",value:function(){this.isPaused&&(this.recorder.resume(),this.isPaused=!1)}},{key:"stop",value:function(){this.recorder.stop(),this.isRecording=!1}}]),e}(),De=function(e){var t=e.large,n=Object(U.a)(e,["large"]);return Object(c.c)("button",Object.assign({sx:{backgroundColor:"transparent",border:"none",position:"relative",overflow:"hidden",my:0,mx:t?"15px":0,padding:0,fontSize:t?"5rem":"3.5rem",lineHeight:t?"5rem":"3.5rem",svg:{margin:0,padding:0,outline:"none"}}},n))},Ee=function(e){return Object(c.c)(De,{onClick:e.onClick,title:e.title},Object(c.c)("span",{className:"fa-layers"},Object(c.c)(D.a,{icon:E.r})))},Re=function(e){return Object(c.c)(De,{onClick:e.onClick,title:e.title,large:e.large?1:0,disabled:e.disabled||e.countdown,sx:{color:"#bd181c","svg + svg":{color:"#e22319"},":disabled":{color:"#aaa"},":disabled svg + svg":{color:"#bbb"}}},Object(c.c)("span",{className:"fa-layers"},Object(c.c)(D.a,{icon:e.countdown?E.h:E.g,spin:e.countdown}),Object(c.c)(D.a,{icon:E.g,transform:"shrink-6"})))},He=function(e){return Object(c.c)(De,{onClick:e.onClick,title:e.title},Object(c.c)("span",{className:"fa-layers"},Object(c.c)(D.a,{icon:E.t})))},Ue=function(e){return Object(c.c)(De,{onClick:e.onClick,title:e.title,large:!!e.large,sx:{color:"#bd181c"}},Object(c.c)(D.a,{icon:E.v}))},Te=n(118),Ie=n(116),Le=n(101),_e=n(119),ze=n(2),Pe=n(23),We=function(e){function t(e){var n;return Object(ke.a)(this,t),n=Object(Te.a)(this,Object(Ie.a)(t).call(this,e)),Object.defineProperty(Object(Le.a)(n),Me,{writable:!0,value:null}),Object.defineProperty(Object(Le.a)(n),Ne,{writable:!0,value:null}),Object.defineProperty(Object(Le.a)(n),Be,{writable:!0,value:!1}),n.state={milliseconds:0},Object(ze.a)(Object(Le.a)(n),Me)[Me]=new Date,Object(ze.a)(Object(Le.a)(n),Ne)[Ne]=setInterval((function(){return n.tick()}),100),n}return Object(_e.a)(t,e),Object(Ce.a)(t,[{key:"componentDidMount",value:function(){Object(ze.a)(this,Be)[Be]=!0}},{key:"componentWillUnmount",value:function(){this.stopTimer(),Object(ze.a)(this,Be)[Be]=!1}},{key:"resumeTimer",value:function(){var e=this;this.timerId||(Object(ze.a)(this,Ne)[Ne]=setInterval((function(){return e.tick()}),100),Object(ze.a)(this,Me)[Me]=new Date)}},{key:"stopTimer",value:function(){clearInterval(Object(ze.a)(this,Ne)[Ne]),Object(ze.a)(this,Ne)[Ne]=null}},{key:"componentDidUpdate",value:function(e){this.props.isPaused!==e.isPaused&&(this.props.isPaused?this.stopTimer():this.resumeTimer())}},{key:"tick",value:function(){if(Object(ze.a)(this,Be)[Be]){var e=new Date,t=e-Object(ze.a)(this,Me)[Me];Object(ze.a)(this,Me)[Me]=e,this.setState((function(e){return{milliseconds:e.milliseconds+t}}))}}},{key:"render",value:function(){var e=this.state.milliseconds,t=[e/36e5>>0,(e/6e4>>0)%60,(e/1e3>>0)%60];0===t[0]&&(t=t.slice(1));var n=t.map((function(e){return(e<10?"0":"")+e})).join(":");return Object(c.c)("span",{sx:{fontSize:3}},n)}}]),t}(a.Component),Me=Object(Pe.a)("last"),Ne=Object(Pe.a)("timerID"),Be=Object(Pe.a)("isMounted"),Fe=We;function qe(e,t){return function(n){var r=n.media,c=n.url,i=n.mimeType,a=n.dimensions;e({type:"ADD_RECORDING",payload:{deviceType:t,media:r,url:c,mimeType:i,dimensions:a}})}}function Ke(e,t){return e&&0!==e.getAudioTracks().length?new MediaStream([].concat(Object(d.a)(t.getVideoTracks()),Object(d.a)(e.getAudioTracks()))):t}function Ve(e){var t=e.handleRecorded,n=e.recordingState,r=e.setRecordingState,i=Object(T.c)().t,o=k(),s=C(),l=s.audioStream,d=s.displayStream,b=s.userStream,p=Object(a.useRef)(null),f=Object(a.useRef)(null),O=d||b;Object(a.useEffect)((function(){p.current=null,f.current=null}),[o]);return Object(c.c)("div",{sx:{m:0,width:n!==Ge?"280px":"auto"}},n!==Ge&&Object(c.c)(u.Beforeunload,{onBeforeunload:function(e){return e.preventDefault()}}),Object(c.c)("div",{className:"buttons",sx:{display:"flex",alignItems:"center"}},n!==Ge&&Object(c.c)("div",{sx:{flex:1,textAlign:"right"}},n===Je&&Object(c.c)(Ee,{title:i("pause-button-title"),recordingState:n,onClick:function(){r(Ye),p.current&&p.current.pause(),f.current&&f.current.pause()}}),n===Ye&&Object(c.c)(He,{title:i("resume-button-title"),recordingState:n,onClick:function(){r(Je),p.current&&p.current.resume(),f.current&&f.current.resume()}})),Object(c.c)("div",{className:"center"},n===Ge?Object(c.c)(Re,{large:!0,title:i("record-button-title"),recordingState:n,onClick:function(){O&&(r(Je),function(){if(d){var e=qe(o,"desktop"),t=Ke(l,d);p.current=new Ae(t,{onStop:e}),p.current.start()}if(b){var n=qe(o,"video"),r=Ke(l,b);f.current=new Ae(r,{onStop:n}),f.current.start()}}())},disabled:!O}):Object(c.c)(Ue,{large:!0,title:i("stop-button-title"),recordingState:n,onClick:function(){r(Ge),p.current&&p.current.stop(),f.current&&f.current.stop(),t()}})),n!==Ge&&Object(c.c)("div",{sx:{flex:1}},Object(c.c)(Fe,{isPaused:n===Ye}))))}var Ge="inactive",Ye="paused",Je="recording";function Qe(e){var t=C(),n=k(),o=Object(de.j)(),s=Object(a.useState)(Ge),l=Object(r.a)(s,2),u=l[0],d=l[1];Object(a.useEffect)((function(){t.displayStream||t.userStream||e.firstStep()}),[e,t.displayStream,t.userStream]);var b=Object(a.useCallback)((function(){e.previousStep()}),[e]);return Object(c.c)(i.e,{sx:{flexDirection:"column",height:"100%",position:"relative",flexGrow:1}},Object(c.c)(we,{recordingState:u}),Object(c.c)("div",{sx:{m:3}},Object(c.c)(ne,{prev:u===Ge&&{onClick:b}},Object(c.c)(Ve,{handleRecorded:function(){o.refreshConnection(),function(e,t){var n=e.audioStream,r=e.displayStream,c=e.userStream;J(n,t),Q(r,t),X(c,t)}(t,n),e.nextStep()},recordingState:u,setRecordingState:d}))))}function Xe(e){var t=Object(T.c)().t,n=k();return Object(c.c)(i.e,{sx:{flexDirection:"column",height:"100%",flexGrow:1,padding:3}},Object(c.c)(A.b.h1,{sx:{textAlign:"center",fontSize:["26px","30px","32px"]}},t("review-heading")),Object(c.c)(Ze,null),Object(c.c)("div",{sx:{mb:3}}),Object(c.c)(ne,{prev:{onClick:function(){window.confirm(t("confirm-discard-recordings"))&&(n({type:"RESET"}),e.firstStep())},danger:!0,label:"review-button-discard-and-record"},next:{onClick:function(){e.nextStep()}}}))}var Ze=function(){var e=C().recordings,t=Object(T.c)().t,n=[o.a.createRef(),o.a.createRef()],r=2===e.length?"desktop"===e[0].deviceType?0:1:null;if(Object(a.useEffect)((function(){if(2===e.length&&n[0].current&&n[1].current){n[r].current.volume=0;var t=null,c=n[0].current,i=n[1].current,a=function(e,n){var r=!1;c.addEventListener(e,(function(e){r||(t=0,n(e,c,i)),r=!r})),i.addEventListener(e,(function(e){r||(t=1,n(e,i,c)),r=!r}))};a("play",(function(e,t,n){n.currentTime=t.currentTime,n.play()})),a("pause",(function(e,t,n){n.currentTime=t.currentTime,n.pause()})),a("seeking",(function(e,t,n){n.currentTime=t.currentTime}));var o=0;window.requestAnimationFrame((function e(){if(o%60===0&&(Math.abs(c.currentTime-i.currentTime)>.15&&t)){var r=n[t].current;n[0===t?1:0].current.currentTime=r.currentTime}o++,window.requestAnimationFrame(e)}))}})),0===e.length)return Object(c.c)(i.g,{title:t("save-creation-waiting-for-recordings")});var s=e.map((function(e,t){return{body:Object(c.c)("video",{ref:n[t],key:t,controls:!0,src:e.url,onLoadedData:function(e){return e.target.currentTime=0},preload:"auto",sx:{width:"100%",height:"100%",backgroundColor:"#ccc",outline:"none"}}),dimensions:function(){return e.dimensions}}}));return Object(c.c)(ie,{gap:20},s)};function $e(e){var t=e.settings,n=e.activeStep,r=e.updateActiveStep;return O()?Object(c.c)(W,{activeStep:n,updateActiveStep:r},Object(c.c)(me,null),Object(c.c)(le,null),Object(c.c)(Qe,{settings:t}),Object(c.c)(Xe,null),Object(c.c)(ge,{settings:t})):null}var et=[{short:"en",long:"English",rtl:!1},{short:"de",long:"Deutsch",rtl:!1},{short:"nl",long:"Dutch",rtl:!1},{short:"el",long:"\u0395\u03bb\u03bb\u03b7\u03bd\u03b9\u03ba\u03ac",rtl:!1},{short:"es",long:"Espa\xf1ol",rtl:!1},{short:"fa",long:"Farsi",rtl:!0},{short:"fr",long:"Fran\xe7ais",rtl:!1},{short:"tr",long:"Turkish",rtl:!1}],tt=function(e){var t=e.errors,n=e.label,r=e.name,i=e.register,a=e.required,o=e.validate,s=void 0===o?void 0:o,l=e.type,u=void 0===l?"text":l,d=Object(U.a)(e,["errors","label","name","register","required","validate","type"]),p=Object(T.c)().t;return Object(c.c)("div",{sx:{"&:not(:last-child)":{mb:3}}},Object(c.c)("label",{sx:{color:"text",display:"block",fontSize:2,fontWeight:"bold"}},n,Object(c.c)("div",{sx:{display:"block",boxSizing:"border-box",clear:"both",fontSize:2,position:"relative",textAlign:"left"}},Object(c.c)("input",Object.assign({"aria-invalid":t[r]?"true":"false","aria-describedby":"".concat(r,"Error"),autoComplete:"off",name:r,ref:i(Object(b.a)({validate:s},a?{required:p("forms-validation-error-required")}:{})),sx:{variant:"styles.input"},type:u},d)),t[r]&&Object(c.c)("p",{id:"".concat(r,"Error"),sx:{color:"error",fontSize:1,fontWeight:"body",mt:1}},t[r].message))))},nt=function(e){var t=e.title,n=e.children;return Object(c.c)(i.a,{sx:{"&:not(:last-child)":{mb:5}}},Object(c.c)(A.b.h2,{sx:{borderBottom:function(e){return"1px solid ".concat(e.colors.gray[2])},pb:1,my:3,mx:0}},t),n)},rt=function(){var e=Object(T.c)().i18n;return Object(c.c)(nt,{title:"Language"},Object(c.c)("select",{sx:{variant:"styles.select"},defaultValue:e.language,onChange:function(t){return e.changeLanguage(t.target.value)}},et.map((function(e){return Object(c.c)("option",{value:e.short,key:e.short},e.long)}))))},ct=n(117);var it=function(e){var t=e.settingsManager,n=Object(l.g)(),o=Object(T.c)().t,u=Object(de.j)(),d=Object(a.useState)(),p=Object(r.a)(d,2),f=p[0],O=p[1],g=Object(ct.a)({defaultValues:t.formValues().opencast}),h=g.errors,j=g.handleSubmit,v=g.register,m=Object(a.useState)("initial"),x=Object(r.a)(m,2),y=x[0],w=x[1],S=C().recordings.length>0;function k(){return(k=Object(B.a)(N.a.mark((function e(n){var r;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return w("testing"),e.next=3,de.a.init(Object(b.a)({},t.settings().opencast,{},n));case 3:r=e.sent,e.t0=r.getState(),e.next=e.t0===de.f?7:e.t0===de.g?12:e.t0===de.h?15:e.t0===de.e?18:e.t0===de.d?21:e.t0===de.c?24:(e.t0,de.i,24);break;case 7:return u.setGlobalInstance(r),t.saveSettings({opencast:n}),w("saved"),O(null),e.abrupt("break",27);case 12:return w("error"),O(o("upload-settings-error-server-unreachable")),e.abrupt("break",27);case 15:return w("error"),O(o("upload-settings-error-response-not-ok")),e.abrupt("break",27);case 18:return w("error"),O(o("upload-settings-error-invalid-response")),e.abrupt("break",27);case 21:return w("error"),u.isLoginProvided()?O(o("upload-settings-invalid-provided-login")):O(o("upload-settings-invalid-login-data")),e.abrupt("break",27);case 24:console.error("bug: invalid state reached..."),w("error"),O("internal error :(");case 27:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var A=t.isConfigurable("opencast.serverUrl"),R=t.isUsernameConfigurable(),H=t.isPasswordConfigurable();if(!A&&!R&&!H)return null;var U={testing:E.h,error:E.k,saved:E.f}[y];return Object(c.c)(nt,{title:o("upload-settings-modal-header")},Object(c.c)(i.a,null,f&&Object(c.c)(ae,{isDanger:!0},f),Object(c.c)("form",{onSubmit:j((function(e){return k.apply(this,arguments)}))},A&&Object(c.c)(tt,{errors:h,label:o("upload-settings-label-server-url"),name:"serverUrl",register:v,validate:function(e){try{var t=new URL(e);return"https:"===t.protocol||"http:"===t.protocol||o("upload-settings-invalid-url-http-start")}catch(r){var n=o("upload-settings-invalid-url");return e.startsWith("https://")||e.startsWith("http://")||(n+=" "+o("upload-settings-invalid-url-http-start")),n}},required:!0}),R&&Object(c.c)(tt,{errors:h,label:o("upload-settings-label-username"),name:"loginName",register:v,required:!0}),H&&Object(c.c)(tt,{errors:h,label:o("upload-settings-label-password"),name:"loginPassword",register:v,required:!0,type:"password"}),Object(c.c)("footer",{sx:{mt:4}},Object(c.c)(i.b,{sx:{verticalAlign:"middle"}},o("upload-settings-button-store")),U&&Object(c.c)(D.a,{icon:U,sx:{ml:"10px",fontSize:"30px",verticalAlign:"middle"},spin:"testing"===y}),S&&"saved"===y&&Object(c.c)(s.b,{to:{pathname:"/",search:n.search},sx:{ml:3,variant:"styles.a"}},o("settings-back-to-recording"))))))},at=function(e){var t=e.settingsManager,n=Object(T.c)().t;return Object(c.c)(i.a,{sx:{width:"100%",maxWidth:960,mx:"auto",p:3}},Object(c.c)("header",null,Object(c.c)(A.b.h1,null,n("settings-header"))),Object(c.c)(rt,null),Object(c.c)(it,{settingsManager:t}))},ot=function(e){e.settings;var t=Object(T.c)().t,n=[];return"https:"!==window.location.protocol&&"localhost"!==window.location.hostname&&"127.0.0.1"!==window.location.hostname&&n.push(Object(c.c)(ae,{key:"unsecure-connection",isDanger:!0},t("warning-https"))),O()||n.push(Object(c.c)(ae,{key:"media-recorder",isDanger:!0},t("warning-recorder-not-supported"),g()&&" "+t("warning-recorder-safari-hint"))),n.length>0?Object(c.c)("div",{sx:{p:3}},n):null};var st=function(e){var t=e.settings,n=e.settingsManager,i=Object(a.useState)(0),o=Object(r.a)(i,2),s=o[0],u=o[1];return Object(c.c)(S,null,Object(c.c)(lt,null),Object(c.c)(l.d,null,Object(c.c)(l.b,{path:"/settings",exact:!0},Object(c.c)(at,{settingsManager:n})),Object(c.c)(l.b,{path:"/about",exact:!0},Object(c.c)(H,null)),Object(c.c)(l.b,{path:"/",exact:!0},Object(c.c)($e,{settings:t,activeStep:s,updateActiveStep:u})),Object(c.c)(l.b,{path:"/*"},Object(c.c)(l.a,{to:"/"}))))},lt=function(){var e=C().recordings;return Object(c.c)(u.Beforeunload,{onBeforeunload:function(t){(null===e||void 0===e?void 0:e.length)>0&&t.preventDefault()}})};t.default=function(e){var t=e.settingsManager,n=Object(a.useState)(t.settings()),o=Object(r.a)(n,2),l=o[0],u=o[1];return t.onChange=function(e){return u(e)},Object(a.useEffect)((function(){console.debug("Current settings: ",l)})),Object(c.c)(s.a,{basename:"/"},Object(c.c)(i.e,{sx:{flexDirection:"column",height:"100%"}},Object(c.c)(P,null),Object(c.c)("main",{sx:{flex:1,display:"flex",flexDirection:"column",minHeight:"285px"}},Object(c.c)(ot,{settings:l}),Object(c.c)(st,{settingsManager:t,settings:l}))))}}}]);
//# sourceMappingURL=4.842e8b15.chunk.js.map