(this["webpackJsonpopencast-react-studio"]=this["webpackJsonpopencast-react-studio"]||[]).push([[4],{141:function(e,t,n){"use strict";n.r(t);var r=n(28),c=n(4),a=n(110),o=n(1),i=n.n(o),s=n(115),l=n(119),u=n(116),d=n(15),b=function(){return"mediaDevices"in navigator&&"getDisplayMedia"in navigator.mediaDevices&&!(/Android|iPhone|iPad|iPod/i.test(navigator.platform)||/Android/i.test(navigator.userAgent))},p=function(){return"mediaDevices"in navigator&&"getUserMedia"in navigator.mediaDevices},h=function(){return/Safari/i.test(navigator.userAgent)},g=function(e,t){switch(t.type){case"SHARE_AUDIO":return Object(d.a)({},e,{audioStream:t.payload,audioAllowed:!0});case"BLOCK_AUDIO":return Object(d.a)({},e,{audioStream:null,audioAllowed:!1});case"UNSHARE_AUDIO":return Object(d.a)({},e,{audioStream:null});case"SHARE_DISPLAY":return Object(d.a)({},e,{displayStream:t.payload,displayAllowed:!0});case"BLOCK_DISPLAY":return Object(d.a)({},e,{displayStream:null,displayAllowed:!1});case"UNSHARE_DISPLAY":return Object(d.a)({},e,{displayStream:null});case"SHARE_USER":return Object(d.a)({},e,{userStream:t.payload,userAllowed:!0});case"BLOCK_USER":return Object(d.a)({},e,{userStream:null,userAllowed:!1});case"UNSHARE_USER":return Object(d.a)({},e,{userStream:null});case"ADD_RECORDING":return Object(d.a)({},e,{recordings:[].concat(Object(u.a)(e.recordings),[t.payload])});case"CLEAR_RECORDINGS":return Object(d.a)({},e,{recordings:[]});default:throw new Error}},O=Object(o.createContext)(null),f=Object(o.createContext)(null),j=function(e){var t=e.children,n=Object(o.useReducer)(g,{audioAllowed:null,audioStream:null,audioSupported:p(),displayAllowed:null,displayStream:null,displaySupported:b(),userAllowed:null,userStream:null,userSupported:p(),recordings:[]}),a=Object(r.a)(n,2),i=a[0],s=a[1];return Object(c.c)(f.Provider,{value:s},Object(c.c)(O.Provider,{value:i},t))},v=function(){return Object(o.useContext)(f)},m=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=Object(o.useContext)(O);return null!==e?t[e]:t},x=n(35),y=n(112),w=n(111),k=function(e){return Object(c.c)(a.a,Object.assign({sx:{background:"gray.2",color:"gray.1",borderWidth:1,borderStyle:"solid",borderColor:"gray.2",borderLeftWidth:3,borderLeftColor:"primary",fontFamily:"monospace",lineHeight:"body",my:3,px:3,py:2,maxWidth:"100%",overflow:"auto",pageBreakInside:"avoid",wordWrap:"break-word"}},e))};function S(){return Object(c.c)("article",null,Object(c.c)(x.b.h2,null,"ELAN e.V."),Object(c.c)(x.b.p,null,"The e-learning academic network (ELAN e.V.) is a German non-profit organization supporting higher-education organizations in all matters related to e-learning. Our services include practical tips about how to use digital technologies in education, legal advice and development of free, open-source software to support education."),Object(c.c)(x.b.h3,null,"Contact"),Object(c.c)(x.b.p,null,"Dr. Norbert Kleinefeld, Gesch\xe4ftsf\xfchrer",Object(c.c)("br",null),"Karlstr. 23",Object(c.c)("br",null),"D-26123 Oldenburg"),Object(c.c)(x.b.p,null,Object(c.c)(y.a,{icon:w.n})," ",Object(c.c)(x.b.a,{href:"https://elan-ev.de"},"elan-ev.de"),Object(c.c)("br",null),Object(c.c)(y.a,{icon:w.j})," ",Object(c.c)(x.b.a,{href:"mailto:kontakt@elan-ev.de"},"kontakt@elan-ev.de"),Object(c.c)("br",null),Object(c.c)(y.a,{icon:w.s})," ",Object(c.c)(x.b.a,{href:"tel:+4944199866610"},"+49\u2009441 998\u2009666\u200910")),Object(c.c)(x.b.p,null,"Registergericht: Amtsgericht Oldenburg",Object(c.c)("br",null),"Registernummer: VR 200644",Object(c.c)("br",null),"USt.-ID-Nr.: DE 265901392"))}var C=function(e){return Object(c.c)(a.d,null,Object(c.c)("article",null,Object(c.c)("header",null,Object(c.c)(x.b.h1,null,"Opencast Studio")),Object(c.c)(x.b.p,null,"A web-based recording studio for ",Object(c.c)(x.b.a,{href:"https://opencast.org"},"Opencast"),"."),Object(c.c)(x.b.p,null,"This is free software under the terms of the"," ",Object(c.c)(x.b.a,{href:"https://github.com/elan-ev/opencast-studio/blob/master/LICENSE"},"MIT License")," ","developed by the ",Object(c.c)(x.b.a,{href:"https://elan-ev.de"},"ELAN e.V.")," in cooperation with the ",Object(c.c)(x.b.a,{href:"https://ethz.ch"},"ETH Z\xfcrich"),"."," Please report bugs or submit new features on the project's ",Object(c.c)(x.b.a,{href:"https://github.com/elan-ev/opencast-studio"},"GitHub page"),"."),Object(c.c)(x.b.p,null,"If you are interested in additional development or integrations into specific tools (e.g. LMS), please contact"," ",Object(c.c)(x.b.a,{href:"mailto:opencast-support@elan-ev.de"},"opencast-support@elan-ev.de"),"."),Object(c.c)(x.b.h2,null,"How it works"),Object(c.c)(x.b.p,null,"Opencast Studio uses the recording capabilities build into browsers to record audio and video streams.\n            The recording happens in the user's browser.\n            No server is involved in the recording.\n            Finally, the recording is transferred directly from the users browser to the target Opencast."),Object(c.c)(x.b.h2,null,"Allow Studio to interact with your Opencast"),Object(c.c)(x.b.p,null,"For Studio to work with your Opencast, your need to allow this on your Opencast by serving a special HTTP header. The mechanism used is called"," ",Object(c.c)(x.b.a,{href:"https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS"},"Cross-Origin Resource Sharing"),"."),Object(c.c)(x.b.p,null,"Here is a list of the required headers in Nginx's configuration format:"),Object(c.c)(k,null,"# Basic open CORS for studio.opencast.org",Object(c.c)("br",null),"add_header Access-Control-Allow-Origin https://studio.opencast.org;",Object(c.c)("br",null),"add_header Access-Control-Allow-Methods 'GET, POST';",Object(c.c)("br",null),"add_header Access-Control-Allow-Credentials true;",Object(c.c)("br",null),"add_header Access-Control-Allow-Headers 'Origin,Content-Type,Accept,Authorization';"),Object(c.c)(x.b.p,null,"For a complete configuration file, take a look at the"," ",Object(c.c)(x.b.a,{href:"https://github.com/opencast/opencast-project-infrastructure/blob/9f09638e922d623cd4d3c91dd90aca39c421530d/ansible-allinone-demo-vm/roles/nginx/templates/nginx.conf#L158-L162"},"test server configuration"),"."),Object(c.c)(x.b.h2,null,"Credits"),Object(c.c)(x.b.p,null,"Thanks to the following people and institutions for contributing to this project:"),Object(c.c)("ul",null,Object(c.c)("li",null,Object(c.c)(x.b.a,{href:"https://github.com/slampunk"},"Duncan Smith")," for starting this project"),Object(c.c)("li",null,Object(c.c)(x.b.a,{href:"https://github.com/cilt-uct"},"University of Cape Town (CILT)")," ","for letting Duncan start the project"),Object(c.c)("li",null,Object(c.c)(x.b.a,{href:"https://ethz.ch"},"ETH Z\xfcrich")," for financial support and testing"),Object(c.c)("li",null,Object(c.c)(x.b.a,{href:"https://github.com/elan-ev"},"ELAN e.V.")," for the final development")),Object(c.c)(S,null),Object(c.c)(x.b.h2,null,"Version"),Object(c.c)(x.b.p,null,"Build date ","2020-02-18",", commit"," ",Object(c.c)(x.b.a,{"aria-label":"Git commit on GitHub",href:"https://github.com/elan-ev/opencast-studio/commit/4a2f862"},"4a2f862"),".")))},A=n(113),D=n(36),R=n(135),E=function(e){var t=e.target,n=e.children,r=e.icon,a=Object(A.a)(e,["target","children","icon"]),i=Object(d.a)({sx:{color:"white",pl:[3,3,"10px"],pr:[3,3,"14px"],textDecoration:"none",fontSize:"18px",height:["auto","auto","100%"],borderLeft:["none","none",function(e){return"1px solid ".concat(e.colors.gray[3])}],display:["block","block","inline-block"],width:["100%","100%","auto"],"&:hover":{backgroundColor:"gray.1"}}},a),l=Object(c.c)(o.Fragment,null,Object(c.c)("div",{sx:{width:"20px",display:"inline-block",textAlign:"right",mr:[3,3,2]}},Object(c.c)(y.a,{icon:r})),n);return t.startsWith("/")?Object(c.c)(s.c,Object.assign({to:t,exact:!0,activeStyle:{backgroundColor:"black"}},i),l):Object(c.c)("a",Object.assign({href:t},i),l)},T=function(e){var t=Object(o.useState)(!1),n=Object(r.a)(t,2),a=n[0],i=n[1],s=function(){return i(!1)},l=Object(D.c)().t;return Object(c.c)(o.Fragment,null,Object(c.c)("button",{onClick:function(){return i(!a)},sx:{display:["inline-block","inline-block","none"],border:function(e){return"2px solid ".concat(e.colors.gray[3])},borderRadius:"10px",color:"white",my:1,px:3,mx:1,fontSize:"20px",whiteSpace:"nowrap",backgroundColor:"transparent","&:hover":{backgroundColor:"gray.1"},"&:active":{}}},l("nav-open-menu-button"),Object(c.c)("span",{sx:{width:"23px",display:"inline-block"}},Object(c.c)(y.a,{icon:a?w.v:w.a,sx:{ml:"10px"}}))),Object(c.c)("nav",{ref:function(e){e&&(e.style.height=a?e.scrollHeight+"px":"")},sx:{overflow:"hidden",zIndex:10,height:["0px","0px","100% !important"],top:[function(e){return e.heights.headerHeight},function(e){return e.heights.headerHeight},0],position:["absolute","absolute","static"],width:["100%","100%","auto"],backgroundColor:["gray.0","gray.0","none"],transition:["height 0.25s ease-out 0s","height 0.25s ease-out 0s","none"],scrollX:["none","none","auto"]}},Object(c.c)(E,{target:"/",icon:w.z,onClick:s},l("nav-recording")),Object(c.c)(E,{target:"/settings",icon:w.A,onClick:s},l("nav-settings")),Object(c.c)(E,{target:"/about",icon:w.o,onClick:s},l("nav-about")),Object(c.c)(E,{target:"https://github.com/elan-ev/opencast-studio/issues",icon:R.a,onClick:s},l("nav-report-issue"))),a&&Object(c.c)("div",{onClick:s,ref:function(e){return e&&(e.style.opacity=1)},sx:{display:[a?"block":"none",a?"block":"none","none"],backgroundColor:"rgba(0, 0, 0, 0.7)",position:"fixed",zIndex:-10,top:0,bottom:0,left:0,right:0,opacity:0,transition:"opacity 0.25s ease-out 0s"}}))},_=function(e){return Object(c.c)("span",Object.assign({sx:{position:"relative",top:"4px",fontSize:"12pt",verticalAlign:"top",display:["none","inline"],borderWidth:1,borderStyle:"solid",borderColor:"gray.2",borderRadius:5,padding:"2px",color:"gray.2"}},e))};function U(){return Object(c.c)("span",null,Object(c.c)(s.b,{to:"/"},Object(c.c)("picture",null,Object(c.c)("source",{media:"(min-width: 920px)",srcSet:"".concat("","/opencast-studio.svg")}),Object(c.c)("img",{src:"".concat("","/opencast-studio-small.svg"),alt:"Opencast Studio",sx:{height:50}}))),Object(c.c)(_,null,"beta"))}var P=function(){return Object(c.c)("header",{sx:{height:function(e){return e.heights.headerHeight},lineHeight:function(e){return e.heights.headerHeight},color:"background",display:"flex",justifyContent:"space-between",position:"relative",zIndex:3}},Object(c.c)("div",{sx:{backgroundColor:"gray.0",position:"absolute",zIndex:-3,height:"100%",width:"100%"}}),Object(c.c)(U,null),Object(c.c)(T,null))};function I(e){var t,n=e.activeStep,r=e.updateActiveStep,a=Object(A.a)(e,["activeStep","updateActiveStep"]),o={currentStep:n+1,totalSteps:(null===(t=a.children)||void 0===t?void 0:t.length)||0,nextStep:function(){u(n+1)},previousStep:function(){u(n-1)},goToStep:l,firstStep:function(){l(1)},lastStep:function(){l(a.children.length)}},s=i.a.Children.map(a.children,(function(e,t){return o.isActive=t===n,o.isActive?function(e){var t=e.type;return"function"===typeof t||"object"===typeof t}(e)?i.a.cloneElement(e,o):e:null}));return Object(c.c)(i.a.Fragment,null,s);function l(e){u(e-1)}function u(e){n!==e&&(!function(e,t){return e<0||e>=t.length}(e,a.children)?r(e):console.error("".concat(e+1," is an invalid step")))}}var L=n(32),H=n.n(L),z=n(37);function N(){return(N=Object(z.a)(H.a.mark((function e(t){var n,r,c=arguments;return H.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=c.length>1&&void 0!==c[1]?c[1]:null,e.prev=1,e.next=4,navigator.mediaDevices.getUserMedia({audio:!n||{deviceId:n},video:!1});case 4:return(r=e.sent).getTracks().forEach((function(e){e.onended=function(){t({type:"UNSHARE_AUDIO"})}})),t({type:"SHARE_AUDIO",payload:r}),e.abrupt("return",!0);case 10:return e.prev=10,e.t0=e.catch(1),console.error("Error: "+e.t0),t({type:"BLOCK_AUDIO"}),e.abrupt("return",!1);case 15:case"end":return e.stop()}}),e,null,[[1,10]])})))).apply(this,arguments)}function F(e){return M.apply(this,arguments)}function M(){return(M=Object(z.a)(H.a.mark((function e(t){var n,r,c=arguments;return H.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=c.length>1&&void 0!==c[1]?c[1]:{video:!0,audio:!1},e.prev=1,e.next=4,navigator.mediaDevices.getDisplayMedia(n);case 4:(r=e.sent).getTracks().forEach((function(e){e.onended=function(){t({type:"UNSHARE_DISPLAY"})}})),t({type:"SHARE_DISPLAY",payload:r}),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(1),console.error("Error: "+e.t0),t({type:"BLOCK_DISPLAY"});case 13:case"end":return e.stop()}}),e,null,[[1,9]])})))).apply(this,arguments)}var W={audio:!0,video:{width:{ideal:1280,max:1920},height:{ideal:720,max:1080}}};function B(e){return G.apply(this,arguments)}function G(){return(G=Object(z.a)(H.a.mark((function e(t){var n,r,c,a=arguments;return H.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.length>1&&void 0!==a[1]?a[1]:null,r=n||W,e.prev=2,e.next=5,navigator.mediaDevices.getUserMedia(r);case 5:(c=e.sent).getTracks().forEach((function(e){e.onended=function(){t({type:"UNSHARE_USER"})}})),t({type:"SHARE_USER",payload:c}),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(2),console.error("Error: "+e.t0),t({type:"BLOCK_USER"});case 14:case"end":return e.stop()}}),e,null,[[2,10]])})))).apply(this,arguments)}function q(e,t){e&&e.getTracks().forEach((function(e){return e.stop()})),t({type:"UNSHARE_AUDIO"})}function V(e){var t=e.prev,n=void 0===t?null:t,r=e.next,o=void 0===r?null:r,i=e.children,s=(e.sx,Object(D.c)().t);return Object(c.c)(a.e,{sx:{alignItems:"center",mt:2}},Object(c.c)(a.a,{sx:{flex:"1 1 0",textAlign:"left"}},n&&Object(c.c)(a.b,{sx:Object(d.a)({whiteSpace:"nowrap"},!0===n.danger?{variant:"buttons.danger"}:{}),onClick:n.onClick,disabled:n.disabled,danger:n.danger||!1},Object(c.c)(y.a,{icon:w.b}),s(n.label||"back-button-label"))),Object(c.c)(a.a,null,i),Object(c.c)(a.a,{sx:{flex:"1 1 0",textAlign:"right"}},o&&Object(c.c)(a.b,{sx:Object(d.a)({whiteSpace:"nowrap","& svg":{mr:0,ml:2}},!0===o.danger?{variant:"buttons.danger"}:{}),onClick:o.onClick,disabled:o.disabled},s(o.label||"next-button-label"),Object(c.c)(y.a,{icon:w.c}))))}var K=function(e){var t=e.isDanger,n=Object(A.a)(e,["isDanger"]);return Object(c.c)("div",Object.assign({sx:{":not(:last-child)":{marginBottom:"1.5rem"},backgroundColor:t?"error":"gray.3",color:t?"background":"currentColor",borderRadius:2,padding:3,position:"relative"}},n))},Y=n(136);function X(e){var t=e.stream,n=(Object(A.a)(e,["stream"]),Object(o.useRef)()),r=Object(c.e)().theme;return Object(o.useEffect)((function(){var e=n.current;if(e){var r=e.getContext("2d");r.lineWidth=2,r.strokeStyle="#f1c40f";var c=(new(window.AudioContext||window.webkitAudioContext)).createMediaStreamSource(t),a=new Y.a(c,{fftSize:1024});return a.animate(r),function(){return a.stop()}}return function(){}}),[r.colors,t]),Object(c.c)("canvas",{ref:n,sx:{width:"80%",height:"100px",bg:"rgba(0,0,0,0.8)",m:3,mb:0,borderRadius:"7px"}})}function Z(e){var t=e.choice,n=e.updateChoice,r=Object(D.c)().t,i=v(),s=m(),l=s.audioStream,u=s.audioAllowed,d="none"===t||"microphone"===t&&!l,b=Object(o.useCallback)((function(){q(l,i),e.previousStep()}),[i,e,l]),p=Object(o.useCallback)((function(){e.nextStep()}),[e]);return Object(c.c)(a.d,{sx:{display:"flex",flexDirection:"column",flex:"1 1 auto",justifyContent:"space-between"}},Object(c.c)(x.b.h1,{sx:{textAlign:"center"}},r("sources-audio-question")),Object(c.c)(a.e,{sx:{flexDirection:["column","row"],maxWidth:850,width:"100%",mx:"auto",mb:3,flex:"1 0 auto",maxHeight:["none","350px"],"& > :first-of-type":{mb:[3,0],mr:[0,3]}}},Object(c.c)(J,{icon:w.p,label:r("sources-audio-microphone"),selected:"microphone"===t,onClick:function(){n("microphone"),function(e){return N.apply(this,arguments)}(i).then((function(e){e||n("none")}))}},l&&Object(c.c)(X,{stream:l}),!1===u&&Object(c.c)(K,{isDanger:!0,sx:{mt:2}},Object(c.c)(a.g,{as:"h3",mb:2},r("source-audio-not-allowed-title")),Object(c.c)(a.i,{variant:"text"},r("source-audio-not-allowed-text")))),Object(c.c)(J,{icon:w.q,label:r("sources-audio-without-audio"),selected:"no-audio"===t,onClick:function(){n("no-audio"),l&&q(l,i)}})),Object(c.c)(V,{prev:{onClick:b},next:{onClick:p,disabled:d}}))}var J=function(e){var t=e.children,n=e.icon,r=e.label,a=e.selected,o=e.onClick,i=a?{backgroundColor:"highlight"}:{};return Object(c.c)("button",{onClick:function(){return a||o()},sx:Object(d.a)({fontFamily:"inherit",color:"gray.0",border:"2px solid black",borderRadius:"8px",flex:"0 1 50%",p:2},i)},Object(c.c)("div",{sx:{display:"block",textAlign:"center",mb:3}},Object(c.c)(y.a,{icon:n,size:"3x"})),Object(c.c)("div",{sx:{fontSize:4}},r),t)},Q=n(42),$=n(122),ee=n(39),te=n(40),ne=n(47),re=n.n(ne),ce=function(){function e(t){Object(ee.a)(this,e),this.server_url=t.serverUrl.endsWith("/")?t.serverUrl.slice(0,-1):t.serverUrl,this.workflow_id=t.workflowId,this.username=t.loginName,this.password=t.loginPassword}return Object(te.a)(e,[{key:"checkConnection",value:function(){var e=Object(z.a)(H.a.mark((function e(){return H.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.login();case 2:return e.next=4,this.validateState();case 4:return e.abrupt("return",!!e.sent);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"loginAndUpload",value:function(){var e=Object(z.a)(H.a.mark((function e(t,n,r,c,a,o,i){var s;return H.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=!0,e.prev=1,e.next=4,this.validateState();case 4:s=e.sent,e.next=11;break;case 7:return e.prev=7,e.t0=e.catch(1),c(e.t0),e.abrupt("return");case 11:if(s){e.next=14;break}return e.next=14,this.login();case 14:this.uploadFromRecordings(t,n,r,c,a,o,i);case 15:case"end":return e.stop()}}),e,this,[[1,7]])})));return function(t,n,r,c,a,o,i){return e.apply(this,arguments)}}()},{key:"uploadFromRecordings",value:function(){var e=Object(z.a)(H.a.mark((function e(t,n,r,c,a,o,i){var s,l,u,d,b,p,h,g,O,f,j,v=this;return H.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.validateState();case 3:if(e.sent){e.next=7;break}return r(),e.abrupt("return");case 7:e.next=13;break;case 9:return e.prev=9,e.t0=e.catch(0),c(e.t0),e.abrupt("return");case 13:return e.prev=13,e.next=16,this.getMediaPackage().then((function(e){var t=(new DOMParser).parseFromString('<?xml version="1.0" encoding="UTF-8"?>\n          <dublincore xmlns="http://www.opencastproject.org/xsd/1.0/dublincore/"\n                      xmlns:dcterms="http://purl.org/dc/terms/"\n                      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">\n              <dcterms:created xsi:type="dcterms:W3CDTF">2001-01-01T01:01Z</dcterms:created>\n              <dcterms:creator>Creator not set</dcterms:creator>\n              <dcterms:extent xsi:type="dcterms:ISO8601">PT5.568S</dcterms:extent>\n              <dcterms:title>Title Not Set</dcterms:title>\n              <dcterms:spatial>Opencast Studio</dcterms:spatial>\n          </dublincore>',"text/xml"),n=t.getElementsByTagName("dcterms:created"),r=t.getElementsByTagName("dcterms:creator"),c=t.getElementsByTagName("dcterms:title");return n[0].textContent=new Date(Date.now()).toISOString(),r[0].textContent=i,c[0].textContent=o,v.addDCCatalog(e.data,(new XMLSerializer).serializeToString(t),"dublincore/episode")}));case 16:s=e.sent,l=!0,u=!1,d=void 0,e.prev=20,b=t[Symbol.iterator]();case 22:if(l=(p=b.next()).done){e.next=35;break}return h=p.value,g=h.deviceType,O=h.media,f="presentation/source","desktop"===g?f="presentation/source":"video"===g&&(f="presenter/source"),"video",j="".concat("desktop"===g?"Presentation":"Presenter"," ").concat("video"," - ").concat(o||"Recording",".webm"),e.next=31,this.addTrack(s.data,O,j,f,"");case 31:s=e.sent;case 32:l=!0,e.next=22;break;case 35:e.next=41;break;case 37:e.prev=37,e.t1=e.catch(20),u=!0,d=e.t1;case 41:e.prev=41,e.prev=42,l||null==b.return||b.return();case 44:if(e.prev=44,!u){e.next=47;break}throw d;case 47:return e.finish(44);case 48:return e.finish(41);case 49:return e.next=51,this.ingest(s.data,this.workflow_id);case 51:e.next=57;break;case 53:return e.prev=53,e.t2=e.catch(13),a(e.t2),e.abrupt("return");case 57:n();case 58:case"end":return e.stop()}}),e,this,[[0,9],[13,53],[20,37,41,49],[42,,44,48]])})));return function(t,n,r,c,a,o,i){return e.apply(this,arguments)}}()},{key:"validateState",value:function(){var e=Object(z.a)(H.a.mark((function e(){var t,n;return H.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getMeInfo();case 2:return t=e.sent,n=t.data,e.abrupt("return","anonymous"!==n.user.username);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"login",value:function(){var e="j_username=".concat(this.username,"&j_password=").concat(this.password,"&_spring_security_remember_me=on"),t="".concat(this.server_url,"/admin_ng/j_spring_security_check");return re()({url:t,method:"post",data:e,withCredentials:!0})}},{key:"getMeInfo",value:function(){var e="".concat(this.server_url,"/info/me.json");return re.a.get(e,{responseType:"text",withCredentials:!0})}},{key:"getMediaPackage",value:function(){var e="".concat(this.server_url,"/ingest/createMediaPackage");return re.a.get(e,{responseType:"text",withCredentials:!0})}},{key:"addDCCatalog",value:function(e,t,n){var r=new FormData;r.append("mediaPackage",e),r.append("dublinCore",t),r.append("flavor",n);var c="".concat(this.server_url,"/ingest/addDCCatalog");return re()({url:c,method:"post",data:r,responseType:"text",withCredentials:!0})}},{key:"addTrack",value:function(e,t,n,r,c){var a=new FormData;a.append("mediaPackage",e),a.append("flavor",r),a.append("tags",c),a.append("BODY",t,n);var o="".concat(this.server_url,"/ingest/addTrack");return re()({url:o,method:"post",data:a,responseType:"text",withCredentials:!0})}},{key:"ingest",value:function(e,t){var n=new FormData;n.append("mediaPackage",e),n.append("workflowDefinitionId",t);var r="".concat(this.server_url,"/ingest/ingest");return re()({url:r,method:"post",data:n,responseType:"text",withCredentials:!0})}}],[{key:"areSettingsComplete",value:function(e){return e&&e.serverUrl&&e.workflowId&&e.loginName&&e.loginPassword}}]),e}();var ae=function(e){return Object(c.c)("div",{sx:{"&:not(:last-child)":{marginBottom:3}}},Object(c.c)("label",{sx:{color:"gray.0",display:"block",fontSize:2,fontWeight:"bold"}},e.label,Object(c.c)("div",{sx:{boxSizing:"border-box",clear:"both",fontSize:2,position:"relative",textAlign:"left"}},e.children)))},oe=function(e){var t,n=e.deviceType,r=e.title,o=e.type,i=e.url,s=e.mimeType,l="desktop"===n?"Presentation":"Presenter";t=s&&s.startsWith("video/webm")?"webm":s&&s.startsWith("video/mp4")?"mp4":h()?"mp4":"webm";var u="".concat(l," ").concat(o," - ").concat(r||"Recording",".").concat(t),b={width:"8rem",height:"4.5rem",position:"relative",backgroundColor:"gray.3",textAlign:"center",padding:"0.5rem",margin:"0 0.5rem 0.5rem 0",color:"transparent",bg:"background"};return i?Object(c.c)("a",{sx:Object(d.a)({},b,{":hover":{video:{opacity:.2},svg:{color:"text"}}}),target:"_blank",download:u,href:i,rel:"noopener noreferrer"},Object(c.c)("video",{autoPlay:!0,muted:!0,sx:{position:"absolute",maxWidth:"100%",maxHeight:"100%",top:"50%",left:"50%",transform:"translate(-50%, -50%)"},src:i}),Object(c.c)(a.a,{sx:{position:"absolute",top:1,right:1,fontSize:4,color:"white"}},Object(c.c)(y.a,{icon:w.m}))):Object(c.c)("a",{sx:b,target:"_blank",href:i,download:u,rel:"noopener noreferrer"},n)},ie=function(e){return Object(c.c)("input",Object.assign({sx:{variant:"styles.input"}},e))},se={error:null,recordingData:{title:"",presenter:""},uploading:!1,uploaded:!1},le=function(e,t){switch(t.type){case"ERROR":return Object(d.a)({},e,{error:t.payload});case"RECORDING_DATA_UPDATE":var n=Object(r.a)(t.payload,2),c=n[0],a=n[1];return Object(d.a)({},e,{recordingData:Object(d.a)({},e.recordingData,Object(Q.a)({},c,a))});case"UPLOAD_FAILURE":return Object(d.a)({},e,{error:t.payload,uploading:!1,uploaded:!1});case"UPLOAD_REQUEST":return Object(d.a)({},e,{error:null,uploading:!0,uploaded:!1});case"UPLOAD_SUCCESS":return Object(d.a)({},e,{error:null,uploading:!1,uploaded:!0});default:throw new Error}};function ue(e){var t=Object(D.c)().t,n=m().recordings,i=Object(o.useReducer)(le,se),l=Object(r.a)(i,2),u=l[0],d=l[1];function b(e){var t=e.target,n="checkbox"===t.type?t.checked:t.value;d({type:"RECORDING_DATA_UPDATE",payload:[t.name,n]})}var p=ce.areSettingsComplete(e.settings.opencast);return Object(c.c)(a.d,null,n.length>0&&Object(c.c)($.Beforeunload,{onBeforeunload:function(e){return e.preventDefault()}}),Object(c.c)("header",null,Object(c.c)(x.b.h2,null,t("save-creation-modal-title"))),Object(c.c)(a.a,null,u.error&&Object(c.c)(K,{isDanger:!0},u.error),u.uploading&&Object(c.c)(K,null,t("upload-notification")),u.uploaded&&Object(c.c)(K,null,t("message-upload-complete")),Object(c.c)(ae,{label:t("save-creation-label-title")},Object(c.c)(ie,{name:"title",autoComplete:"off",value:u.recordingData.title,onChange:b})),Object(c.c)(ae,{label:t("save-creation-label-presenter")},Object(c.c)(ie,{name:"presenter",autoComplete:"off",value:u.recordingData.presenter,onChange:b}))),Object(c.c)("header",null,Object(c.c)(x.b.h2,null,t("save-creation-label-media"))),Object(c.c)("div",{sx:{flex:1}},Object(c.c)("div",{sx:{display:"flex",maxHeight:"6.5rem",overflowY:"auto",flexWrap:"wrap"}},0===n.length?Object(c.c)(a.h,{title:t("save-creation-waiting-for-recordings")}):n.map((function(e,t){return Object(c.c)(oe,{key:t,deviceType:e.deviceType,title:u.recordingData.title,type:"video",mimeType:e.mimeType,url:e.url})})))),Object(c.c)("footer",{sx:{mt:4,button:{minWidth:100,width:["100%","auto"],"& + button":{ml:[0,2],mt:[2,"auto"]}}}},!p&&Object(c.c)(K,{key:"opencast-connection",isDanger:!0},Object(c.c)(D.a,{i18nKey:"warning-missing-connection-settings"},"Warning. ",Object(c.c)(s.b,{to:"/settings",sx:{variant:"styles.a"}},"setting"))),Object(c.c)(a.b,{onClick:function(){var r=u.recordingData,c=r.title,a=r.presenter;""!==c&&""!==a?(d({type:"UPLOAD_REQUEST"}),new ce(e.settings.opencast).loginAndUpload(n.filter(Boolean),(function(){d({type:"UPLOAD_SUCCESS"})}),(function(){d({type:"UPLOAD_FAILURE",payload:t("message-login-failed")})}),(function(e){d({type:"UPLOAD_FAILURE",payload:t("message-server-unreachable")})}),(function(e){d({type:"UPLOAD_FAILURE",payload:t("message-conn-failed")})}),c,a)):d({type:"ERROR",payload:t("save-creation-form-invalid")})},disabled:0===n.length||u.uploading||u.uploaded||!p},Object(c.c)(y.a,{icon:w.x}),Object(c.c)("span",null,u.uploading?t("save-creation-button-uploading"):u.uploaded?t("save-creation-button-uploaded"):t("save-creation-button-upload"))),Object(c.c)(a.b,{onClick:function(){e.previousStep()},variant:"text"},Object(c.c)(y.a,{icon:w.w}),Object(c.c)("span",null,t("save-creation-button-discard-and-record")))))}function de(e){e.reselectSource;var t,n=e.warnings,r=e.inputs,i=Object(D.c)().t;switch(r.length){case 1:t=Object(c.c)(be,{input:r[0],text:i("sources-select-user")});break;case 2:t=Object(c.c)(a.f,{gap:3,columns:[1,2],sx:{minHeight:0}},Object(c.c)(be,{input:r[0],text:i("sources-select-display")}),Object(c.c)(be,{input:r[1],text:i("sources-select-user")}));break;default:return Object(c.c)("p",null,"Something went very wrong")}return Object(c.c)(o.Fragment,null,n,t)}function be(e){var t,n,r=e.input,o=e.text,i=r.stream,s=null===i||void 0===i?void 0:null===(t=i.getVideoTracks())||void 0===t?void 0:t[0],l=null!==(n=null===s||void 0===s?void 0:s.getSettings())&&void 0!==n?n:{},u=l.width,d=l.height;return Object(c.c)(a.c,{sx:{display:"flex",flexDirection:"column",flex:"0 1 auto",minHeight:0}},Object(c.c)(pe,{allowed:r.allowed,stream:i}),Object(c.c)(a.i,{p:2,color:"muted"},o,s&&": ".concat(u,"\xd7").concat(d)))}var pe=function(e){var t,n=e.allowed,r=e.stream,i=(Object(A.a)(e,["allowed","stream"]),Object(o.useRef)());return Object(o.useEffect)((function(){return i.current&&(i.current.srcObject=r),function(){}}),[r]),r?Object(c.c)("video",{ref:i,autoPlay:!0,muted:!0,sx:{minHeight:0,display:"block",width:"100%",height:"100%"}}):(t=!1===n?Object(c.c)(y.a,{icon:w.l,size:"3x"}):Object(c.c)(a.h,{size:"75"}),Object(c.c)("div",{sx:{width:"100%",height:"100%",minHeight:"120px",display:"flex",justifyContent:"center",alignItems:"center"}},t))};function he(e){var t,n,i,s=Object(D.c)().t,l=v(),u=m(),d=u.displayStream,b=u.userStream,p=u.displaySupported,h=u.userSupported,g=d||b,O=p||h,f=p&&h,j=Object(o.useState)((d&&b?"both":d&&"display")||b&&"user"||"none"),y=Object(r.a)(j,2),k=y[0],S=y[1],C={video:{height:{ideal:1080},facingMode:"user"},audio:!1},A=function(){var e=Object(z.a)(H.a.mark((function e(){return H.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return S("user"),e.next=3,B(l,C);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),R=function(){var e=Object(z.a)(H.a.mark((function e(){return H.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return S("display"),e.next=3,F(l);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),E=function(){var e=Object(z.a)(H.a.mark((function e(){return H.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return S("both"),e.next=3,B(l,C);case 3:return e.next=5,F(l);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),T=function(){S("none"),function(e,t){var n=e.audioStream,r=e.displayStream,c=e.userStream;q(n,t),function(e,t){e&&e.getTracks().forEach((function(e){return e.stop()})),t({type:"UNSHARE_DISPLAY"})}(r,t),function(e,t){e&&e.getTracks().forEach((function(e){return e.stop()})),t({type:"UNSHARE_USER"})}(c,t)}(u,l)},_="none"===k||"both"===k?!d||!b:!g,U=!1===u.userAllowed&&Object(c.c)(K,{isDanger:!0},Object(c.c)(a.g,{as:"h3",mb:2},s("source-user-not-allowed-title")),Object(c.c)(a.i,null,s("source-user-not-allowed-text"))),P=!1===u.displayAllowed&&Object(c.c)(K,{isDanger:!0},Object(c.c)(a.g,{as:"h3",mb:2},s("source-display-not-allowed-title")),Object(c.c)(a.i,null,s("source-display-not-allowed-text")));switch(k){case"none":n=s("sources-video-question"),t=!0,i=O?Object(c.c)(a.e,{sx:{flexDirection:["column","row"],maxWidth:[270,850],width:"100%",mx:["auto","none"],mb:3,flex:"1 1 auto",maxHeight:["none","270px"],minHeight:[0,""],justifyContent:"center","& > :not(:last-of-type)":{mb:[3,0],mr:[0,3]}}},p&&Object(c.c)(ge,{label:s("sources-scenario-display"),icon:w.d,onClick:R}),f&&Object(c.c)(ge,{label:s("sources-scenario-display-and-user"),icon:w.e,onClick:E}),h&&Object(c.c)(ge,{label:s("sources-scenario-user"),icon:w.y,onClick:A})):Object(c.c)(K,{isDanger:!0},s("sources-video-none-available"));break;case"user":n=s("sources-video-user-selected"),t=!u.userStream&&!1!==u.userAllowed,i=Object(c.c)(de,{reselectSource:T,warnings:U,inputs:[{stream:u.userStream,allowed:u.userAllowed}]});break;case"display":n=s("sources-video-display-selected"),t=!u.displayStream&&!1!==u.displayAllowed,i=Object(c.c)(de,{reselectSource:T,warnings:P,inputs:[{stream:u.displayStream,allowed:u.displayAllowed}]});break;case"both":n=s("sources-video-display-and-user-selected"),t=!u.userStream&&!1!==u.userAllowed||!u.displayStream&&!1!==u.displayAllowed,i=Object(c.c)(de,{reselectSource:T,warnings:[P,U],inputs:[{stream:u.displayStream,allowed:u.displayAllowed},{stream:u.userStream,allowed:u.userAllowed}]});break;default:return Object(c.c)("p",null,"Something went very wrong")}return Object(c.c)(a.d,{sx:{display:"flex",flexDirection:"column",flex:"1 1 auto",minHeight:0}},Object(c.c)(x.b.h1,{sx:{textAlign:"center",fontSize:["26px","30px","32px"]}},n),Object(c.c)(Oe,null),i,Object(c.c)(Oe,null),!t&&Object(c.c)(V,{next:{onClick:function(){return e.nextStep()},disabled:_},prev:{onClick:T,disabled:!1,label:"sources-video-reselect-source",danger:!0}}))}var ge=function(e){var t=e.icon,n=e.label,r=e.onClick;return Object(c.c)("button",{onClick:r,sx:{fontFamily:"inherit",color:"gray.0",border:"2px solid black",borderRadius:"8px",flex:["1 1 auto","0 1 100%"],minWidth:"180px",maxWidth:"300px",minHeight:"120px",maxHeight:"250px",p:2}},Object(c.c)("div",{sx:{display:"block",textAlign:"center",mb:3}},Object(c.c)(y.a,{icon:t,size:"3x"})),Object(c.c)("div",{sx:{fontSize:4}},n))},Oe=function(){return Object(c.c)("div",{sx:{flex:"1 0 0"}})};function fe(e){var t=e.onClick,n=e.title,r=(e.icon,e.stream),a=Object(o.useRef)();return Object(o.useEffect)((function(){a.current&&"undefined"!=typeof r&&(a.current.srcObject=r)})),Object(c.c)("div",{onClick:r?null:t,"data-title":n,sx:{backgroundColor:"gray.3",boxShadow:"0 2px 2px rgba(0, 0, 0, 0.35)",overflow:"hidden",zIndex:"0",cursor:r?"initial":"pointer",position:"relative",display:"flex",flexDirection:"column",alignItems:"center"}},Object(c.c)("video",{ref:a,autoPlay:!0,muted:!0,sx:{outline:"none",position:"absolute",top:0,left:0,width:"100%",height:"100%",zIndex:2,background:"transparent"}}))}function je(e){var t=Object(D.c)().t,n=m(),r=n.displayStream,a=n.userStream;return Object(c.c)("div",{sx:{flex:1,display:"flex",flexDirection:["column","row"],justifyContent:"center",flexWrap:"wrap","& > *":{flex:"1 0 50%"}}},r&&Object(c.c)(fe,{title:t("share-desktop"),icon:w.i,stream:r}),a&&Object(c.c)(fe,{title:t("share-camera"),icon:w.z,stream:a}))}var ve=function(){function e(t){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object(ee.a)(this,e);var c=r.mimeType||void 0,a=[];this.recorder=new MediaRecorder(t,{mimeType:c}),this.recorder.ondataavailable=function(e){e.data.size>0&&a.push(e.data)},this.recorder.onerror=function(e){r.onError&&r.onError(e)},this.recorder.onstop=function(){var e=a[0].type||n.recorder.mimeType,t=new Blob(a,{type:e}),c=URL.createObjectURL(t);n.recorder=null,r.onStop&&r.onStop({url:c,media:t,mimeType:e})},this.isRecording=!1,this.isPaused=!1}return Object(te.a)(e,[{key:"start",value:function(){this.isRecording||(this.recorder.start(),this.isRecording=!0)}},{key:"pause",value:function(){this.isPaused||(this.recorder.pause(),this.isPaused=!0)}},{key:"resume",value:function(){this.isPaused&&(this.recorder.resume(),this.isPaused=!1)}},{key:"stop",value:function(){this.recorder.stop(),this.isRecording=!1}}]),e}(),me=function(e){var t=e.large,n=Object(A.a)(e,["large"]);return Object(c.c)("button",Object.assign({sx:{backgroundColor:"transparent",border:"none",position:"relative",overflow:"hidden",my:0,padding:t?"0.5rem":"0.25rem",fontSize:t?"5rem":"2.5rem",lineHeight:t?"5rem":"2.5rem",svg:{margin:0,padding:0,outline:"none"}}},n))},xe=function(e){return Object(c.c)(me,{onClick:e.onClick,title:e.title},Object(c.c)("span",{className:"fa-layers"},Object(c.c)(y.a,{icon:w.r})))},ye=function(e){return Object(c.c)(me,{onClick:e.onClick,title:e.title,large:e.large?1:0,disabled:e.disabled||e.countdown,sx:{color:"#bd181c","svg + svg":{color:"#e22319"},":disabled":{color:"#aaa"},":disabled svg + svg":{color:"#bbb"}}},Object(c.c)("span",{className:"fa-layers"},Object(c.c)(y.a,{icon:e.countdown?w.h:w.g,spin:e.countdown}),Object(c.c)(y.a,{icon:w.g,transform:"shrink-6"})))},we=function(e){return Object(c.c)(me,{onClick:e.onClick,title:e.title},Object(c.c)("span",{className:"fa-layers"},Object(c.c)(y.a,{icon:w.t})))},ke=function(e){return Object(c.c)(me,{onClick:e.onClick,title:e.title,large:!!e.large,sx:{color:"#bd181c"}},Object(c.c)(y.a,{icon:w.u}))},Se=n(139),Ce=n(137),Ae=n(123),De=n(140),Re=n(17),Ee=n(46),Te=function(e){function t(e){var n;return Object(ee.a)(this,t),n=Object(Se.a)(this,Object(Ce.a)(t).call(this,e)),Object.defineProperty(Object(Ae.a)(n),_e,{writable:!0,value:null}),Object.defineProperty(Object(Ae.a)(n),Ue,{writable:!0,value:null}),Object.defineProperty(Object(Ae.a)(n),Pe,{writable:!0,value:!1}),n.state={milliseconds:0},Object(Re.a)(Object(Ae.a)(n),_e)[_e]=new Date,Object(Re.a)(Object(Ae.a)(n),Ue)[Ue]=setInterval((function(){return n.tick()}),100),n}return Object(De.a)(t,e),Object(te.a)(t,[{key:"componentDidMount",value:function(){Object(Re.a)(this,Pe)[Pe]=!0}},{key:"componentWillUnmount",value:function(){this.stopTimer(),Object(Re.a)(this,Pe)[Pe]=!1}},{key:"resumeTimer",value:function(){var e=this;this.timerId||(Object(Re.a)(this,Ue)[Ue]=setInterval((function(){return e.tick()}),100),Object(Re.a)(this,_e)[_e]=new Date)}},{key:"stopTimer",value:function(){clearInterval(Object(Re.a)(this,Ue)[Ue]),Object(Re.a)(this,Ue)[Ue]=null}},{key:"componentDidUpdate",value:function(e){this.props.isPaused!==e.isPaused&&(this.props.isPaused?this.stopTimer():this.resumeTimer())}},{key:"tick",value:function(){if(Object(Re.a)(this,Pe)[Pe]){var e=new Date,t=e-Object(Re.a)(this,_e)[_e];Object(Re.a)(this,_e)[_e]=e,this.setState((function(e){return{milliseconds:e.milliseconds+t}}))}}},{key:"render",value:function(){var e=this.state.milliseconds,t=[e/36e5>>0,(e/6e4>>0)%60,(e/1e3>>0)%60];0===t[0]&&(t=t.slice(1));var n=t.map((function(e){return(e<10?"0":"")+e})).join(":");return Object(c.c)("span",null,n)}}]),t}(o.Component),_e=Object(Ee.a)("last"),Ue=Object(Ee.a)("timerID"),Pe=Object(Ee.a)("isMounted"),Ie=Te;function Le(e,t){return function(n){var r=n.media,c=n.url,a=n.mimeType;e({type:"ADD_RECORDING",payload:{deviceType:t,media:r,url:c,mimeType:a}})}}function He(e,t){return e&&0!==e.getAudioTracks().length?new MediaStream([].concat(Object(u.a)(t.getVideoTracks()),Object(u.a)(e.getAudioTracks()))):t}function ze(e){var t=e.handleRecorded,n=e.handleStart,a=Object(D.c)().t,i=v(),s=m(),l=s.audioStream,u=s.displayStream,d=s.userStream,b=Object(o.useState)(!1),p=Object(r.a)(b,2),h=p[0],g=p[1],O=Object(o.useState)("inactive"),f=Object(r.a)(O,2),j=f[0],x=f[1],y=Object(o.useRef)(null),w=Object(o.useRef)(null),k=u||d;Object(o.useEffect)((function(){i({type:"CLEAR_RECORDINGS"}),y.current=null,w.current=null}),[i]);return Object(c.c)("div",{sx:{m:0,width:"inactive"!==j?"290px":"auto"}},"inactive"!==j&&Object(c.c)($.Beforeunload,{onBeforeunload:function(e){return e.preventDefault()}}),Object(c.c)("div",{className:"buttons",sx:{display:"flex",alignItems:"center"}},"inactive"!==j&&Object(c.c)("div",{sx:{flex:1,textAlign:"right"}},"recording"===j&&Object(c.c)(xe,{title:a("pause-button-title"),recordingState:j,onClick:function(){x("paused"),y.current&&y.current.pause(),w.current&&w.current.pause()}}),"paused"===j&&Object(c.c)(we,{title:a("resume-button-title"),recordingState:j,onClick:function(){x("recording"),y.current&&y.current.resume(),w.current&&w.current.resume()}})),Object(c.c)("div",{className:"center"},"inactive"===j?Object(c.c)(ye,{large:!0,title:a("record-button-title"),recordingState:j,onClick:function(){k&&(g(!0),setTimeout((function(){x("recording"),g(!1),function(){if(n(),u){var e=Le(i,"desktop"),t=He(l,u);y.current=new ve(t,{onStop:e}),y.current.start()}if(d){var r=Le(i,"video"),c=He(l,d);w.current=new ve(c,{onStop:r}),w.current.start()}}()}),1e3))},disabled:!k,countdown:h}):Object(c.c)(ke,{large:!0,title:a("stop-button-title"),recordingState:j,onClick:function(){x("inactive"),y.current&&y.current.stop(),w.current&&w.current.stop(),t()}})),"inactive"!==j&&Object(c.c)("div",{sx:{flex:1}},Object(c.c)(Ie,{isPaused:"paused"===j}))))}function Ne(e){var t=m();Object(o.useEffect)((function(){t.displayStream||t.userStream||e.firstStep()}),[e,t.displayStream,t.userStream]);var n=Object(o.useState)(!1),i=Object(r.a)(n,2),s=i[0],l=i[1],u=Object(o.useCallback)((function(){e.previousStep()}),[e]);return Object(c.c)(a.e,{sx:{flexDirection:"column",height:"100%",position:"relative",flexGrow:1}},Object(c.c)(je,null),Object(c.c)("div",{sx:{mx:3}},Object(c.c)(V,{prev:!s&&{onClick:u}},Object(c.c)(ze,{handleRecorded:function(){e.nextStep()},handleStart:function(){l(!0)}}))))}function Fe(e){var t=e.settings,n=e.activeStep,a=e.updateActiveStep,i=Object(o.useState)("none"),s=Object(r.a)(i,2),l=s[0],u=s[1];return Object(c.c)(o.Fragment,null,Object(c.c)(I,{activeStep:n,updateActiveStep:a},Object(c.c)(he,null),Object(c.c)(Z,{choice:l,updateChoice:u}),Object(c.c)(Ne,{settings:t}),Object(c.c)(ue,{settings:t})))}var Me=[{short:"en",long:"English",rtl:!1},{short:"de",long:"Deutsch",rtl:!1},{short:"nl",long:"Dutch",rtl:!1},{short:"el",long:"\u0395\u03bb\u03bb\u03b7\u03bd\u03b9\u03ba\u03ac",rtl:!1},{short:"es",long:"Espa\xf1ol",rtl:!1},{short:"fa",long:"Farsi",rtl:!0},{short:"fr",long:"Fran\xe7ais",rtl:!1},{short:"tr",long:"Turkish",rtl:!1}],We=function(e){var t=e.errors,n=e.label,r=e.name,a=e.register,o=e.required,i=e.validate,s=void 0===i?void 0:i,l=e.type,u=void 0===l?"text":l,b=Object(A.a)(e,["errors","label","name","register","required","validate","type"]),p=Object(D.c)().t;return Object(c.c)("div",{sx:{"&:not(:last-child)":{mb:3}}},Object(c.c)("label",{sx:{color:"text",display:"block",fontSize:2,fontWeight:"bold"}},n,Object(c.c)("div",{sx:{display:"block",boxSizing:"border-box",clear:"both",fontSize:2,position:"relative",textAlign:"left"}},Object(c.c)("input",Object.assign({"aria-invalid":t[r]?"true":"false","aria-describedby":"".concat(r,"Error"),autoComplete:"off",name:r,ref:a(Object(d.a)({validate:s},o?{required:p("forms-validation-error-required")}:{})),sx:{variant:"styles.input"},type:u},b)),t[r]&&Object(c.c)("p",{id:"".concat(r,"Error"),sx:{color:"error",fontSize:1,fontWeight:"body",mt:1}},t[r].message))))},Be=function(e){var t=e.title,n=e.children;return Object(c.c)(a.a,{sx:{"&:not(:last-child)":{mb:5}}},Object(c.c)(x.b.h2,{sx:{borderBottom:function(e){return"1px solid ".concat(e.colors.gray[2])},pb:1,my:3,mx:0}},t),n)},Ge=function(){var e=Object(D.c)().i18n;return Object(c.c)(Be,{title:"Language"},Object(c.c)("select",{sx:{variant:"styles.select"},defaultValue:e.language,onChange:function(t){return e.changeLanguage(t.target.value)}},Me.map((function(e){return Object(c.c)("option",{value:e.short,key:e.short},e.long)}))))},qe=n(138);var Ve=function(e){var t=e.settingsManager,n=Object(D.c)().t,i=Object(o.useState)(),l=Object(r.a)(i,2),u=l[0],b=l[1],p=Object(qe.a)({defaultValues:t.formValues().opencast}),h=p.errors,g=p.handleSubmit,O=p.register,f=Object(o.useState)("initial"),j=Object(r.a)(f,2),v=j[0],x=j[1],k=m().recordings.length>0;function S(){return(S=Object(z.a)(H.a.mark((function e(r){var c;return H.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return x("testing"),c=new ce(Object(d.a)({},t.settings().opencast,{},r)),e.prev=2,e.next=5,c.checkConnection();case 5:if(e.sent){e.next=10;break}return x("error"),b(n("upload-settings-validation-error")),e.abrupt("return");case 10:t.saveSettings({opencast:r}),x("saved"),b(null),e.next=20;break;case 15:e.prev=15,e.t0=e.catch(2),console.log(e.t0),x("error"),b(n("message-server-unreachable"));case 20:case"end":return e.stop()}}),e,null,[[2,15]])})))).apply(this,arguments)}var C=t.isFixed("opencast.serverUrl"),A=t.isFixed("opencast.workflowId"),R=t.isFixed("opencast.loginName"),E=t.isFixed("opencast.loginPassword");if(C&&A&&R&&E)return null;var T={testing:w.h,error:w.k,saved:w.f}[v];return Object(c.c)(Be,{title:n("upload-settings-modal-header")},Object(c.c)(a.a,null,u&&Object(c.c)(K,{isDanger:!0},u),Object(c.c)("form",{onSubmit:g((function(e){return S.apply(this,arguments)}))},!C&&Object(c.c)(We,{errors:h,label:n("upload-settings-label-server-url"),name:"serverUrl",register:O,validate:function(e){try{var t=new URL(e);return"https:"===t.protocol||"http:"===t.protocol||n("upload-settings-invalid-url-http-start")}catch(c){var r=n("upload-settings-invalid-url");return e.startsWith("https://")||e.startsWith("http://")||(r+=" "+n("upload-settings-invalid-url-http-start")),r}},required:!0}),!A&&Object(c.c)(We,{errors:h,label:n("upload-settings-label-workflow-id"),name:"workflowId",register:O,required:!0}),!R&&Object(c.c)(We,{errors:h,label:n("upload-settings-label-username"),name:"loginName",register:O,required:!0}),!E&&Object(c.c)(We,{errors:h,label:n("upload-settings-label-password"),name:"loginPassword",register:O,required:!0,type:"password"}),Object(c.c)("footer",{sx:{mt:4}},Object(c.c)(a.b,{sx:{verticalAlign:"middle"}},n("upload-settings-button-store")),T&&Object(c.c)(y.a,{icon:T,sx:{ml:"10px",fontSize:"30px",verticalAlign:"middle"},spin:"testing"===v}),k&&"saved"===v&&Object(c.c)(s.b,{to:"/",sx:{ml:3,variant:"styles.a"}},n("settings-back-to-recording"))))))},Ke=function(e){var t=e.settingsManager,n=Object(D.c)().t;return Object(c.c)(a.a,{sx:{width:"100%",maxWidth:960,mx:"auto",p:3}},Object(c.c)("header",null,Object(c.c)(x.b.h1,null,n("settings-header"))),Object(c.c)(Ge,null),Object(c.c)(Ve,{settingsManager:t}))},Ye=function(e){e.settings;var t=Object(D.c)().t,n=[];return"https:"!==window.location.protocol&&"localhost"!==window.location.hostname&&"127.0.0.1"!==window.location.hostname&&n.push(Object(c.c)(K,{key:"unsecure-connection",isDanger:!0},t("warning-https"))),"undefined"===typeof MediaRecorder&&n.push(Object(c.c)(K,{key:"media-recorder",isDanger:!0},t("warning-recorder-not-supported"),h()&&" "+t("warning-recorder-safari-hint"))),n.length>0?Object(c.c)("div",{sx:{p:3}},n):null};t.default=function(e){var t=e.settingsManager,n=Object(o.useState)(t.settings()),i=Object(r.a)(n,2),u=i[0],d=i[1];t.onChange=function(e){return d(e)};var b=Object(o.useState)(0),p=Object(r.a)(b,2),h=p[0],g=p[1];return Object(c.c)(j,null,Object(c.c)(s.a,{basename:"/"},Object(c.c)(a.e,{sx:{flexDirection:"column",height:"100%"}},Object(c.c)(P,null),Object(c.c)("main",{sx:{flex:1,display:"flex",flexDirection:"column",minHeight:"285px"}},Object(c.c)(Ye,{settings:u}),Object(c.c)(l.d,null,Object(c.c)(l.b,{path:"/settings",exact:!0},Object(c.c)(Ke,{settingsManager:t})),Object(c.c)(l.b,{path:"/about",exact:!0},Object(c.c)(C,null)),Object(c.c)(l.b,{path:"/",exact:!0},Object(c.c)(Fe,{settings:u,activeStep:h,updateActiveStep:g})),Object(c.c)(l.b,{path:"/*"},Object(c.c)(l.a,{to:"/"})))))))}}}]);
//# sourceMappingURL=4.75324d8e.chunk.js.map